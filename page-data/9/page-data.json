{"componentChunkName":"component---src-templates-index-js","path":"/9","result":{"pageContext":{"pageAllCount":89,"group":[{"node":{"id":"4e73be01-4c68-5088-b080-f4fc9002ae45","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/1e207791889ca13b322aad1f9814efd4/8ae78/viewGroup.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz4WQvUsDQRDF76+0stBSsLWQYLDwC7Qyoo0oabRIoXVIEbExJjGXBAnhcpjI5cD7MruX283t3s5IchjhRHzFwDzmN/MYDf+QUgoR66/9tZ3jzcOz9fxJrnCdmdEyPQAoAABMFCBi13jLFa4OLm93L4qFm/t/4MzxOI7DiHnB54SGEeNSyiRJpJRprixsvI+fu/1ap1fr9NxggghCxEKIBSLSdYwxIYSU8geGRc2fF1e3jzb2T1e29ipPL4j44TiNRsM0TUopAFBKDcNoNpue52nLhPMkANW6XipX7yqPpfKDadkIihDqeR4hhHOOiLPZjBDi+/50OtVSUn5r/itEUMnST5IkNX9Li6LItm3XdTnnAMA493zfsixCqViQYRiOx2Pf9xljWTgIgna7PRgMCCFKqTAMR6NRq9VyHCeO569yXVfX9eFwSCnNwF/EHvWL4zIuSwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"布局\"\n        title=\"布局\"\n        src=\"/blog/static/1e207791889ca13b322aad1f9814efd4/00d43/viewGroup.png\"\n        srcset=\"/blog/static/1e207791889ca13b322aad1f9814efd4/63868/viewGroup.png 250w,\n/blog/static/1e207791889ca13b322aad1f9814efd4/0b533/viewGroup.png 500w,\n/blog/static/1e207791889ca13b322aad1f9814efd4/00d43/viewGroup.png 1000w,\n/blog/static/1e207791889ca13b322aad1f9814efd4/8ae78/viewGroup.png 1096w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n安卓的页面是通过ViewGroup + View的组合来实现。</p>\n<ul>\n<li>ViewGroup是布局容器，它定义内部视图的展示方式。</li>\n<li>View是视图组件，例如Button、TextView等。</li>\n</ul>\n<h2>LinearLayout(线性布局)</h2>\n<p>LinearLayout会将它包含的元素按照水平或者垂直方向线性排布。</p>\n<h3>LinearLayout布局属性</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>值</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/LinearLayout#attr_android:orientation\">android:orientation</a></td>\n<td>horizontal/vertical</td>\n<td>水平/垂直布局</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/LinearLayout#attr_android:gravity\">android:gravity</a></td>\n<td>left、right、top等</td>\n<td>定义内部元素的对齐方式,默认left</td>\n</tr>\n</tbody>\n</table>\n<h3>LinearLayout子控件属性</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>值</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/LinearLayout.LayoutParams#attr_android:layout_weight\">android:layout_weight</a></td>\n<td>数字</td>\n<td>布局权重，结合layout_width可以实现均等分布</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/LinearLayout.LayoutParams#attr_android:layout_gravity\">android:layout_gravity</a></td>\n<td>left、right、top等</td>\n<td>定义组件在非主轴上的对齐方式，会影响父布局gravity的作用</td>\n</tr>\n</tbody>\n</table>\n<h2>RelativeLayout(相对布局)</h2>\n<p>RelativeLayout是以相对位置显示子视图的视图组，每个视图的位置可以指定为相对于同级元素的位置或者相对于父级的位置。</p>\n<h3>RelativeLayout子控件属性</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams#attr_android:layout_alignParentTop\">android:layout_alignParentXXX</a></td>\n<td>相对于父元素的位置对齐</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams#attr_android:layout_below\">android:layout_below/above</a></td>\n<td>定位在指定视图的上面或下面</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams#attr_android:layout_toRightOf\">android:layout_toXXXOf</a></td>\n<td>定位到指定视图的左右边缘</td>\n</tr>\n</tbody>\n</table>\n<h2>ConstraintLayout</h2>\n<p>ConstraintLayout与RelativeLayout相似，视图均根据同级视图与父布局之间的关系进行布局。在ConstraintLayout中定义的视图必须至少添加一个水平约束条件和一个垂直约束条件。ConstraintLayout的布局方式能有效的解决嵌套问题，优化页面性能。</p>\n<h3>ConstraintLayout子控件属性</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_constraintXXX_toXXXOf=\"id/parent\"</a></td>\n<td>相对于另一个元素或者容器布局</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_marginXXX</a></td>\n<td>定义外边距</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_constraintXXX_bias</a></td>\n<td>通常用与调整视图水平/垂直位置</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_goneMarginXXX</a></td>\n<td>定义当相对视图不可见时候的边距</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_minXXX / maxXXX</a></td>\n<td>定义组件的宽度限制条件</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.android.google.cn/reference/androidx/constraintlayout/widget/ConstraintLayout?hl=zh-cn\">android:layout_constraintXXX_percent</a></td>\n<td>百分比布局</td>\n</tr>\n</tbody>\n</table>\n<h2>自定义视图</h2>\n<p>在业务开发中，不同页面的组件能力共享能有效减少业务逻辑的重复。下面以一个按钮为例子了解创建自定义视图的流程。</p>\n<h3>创建组件</h3>\n<p>新建一个类继承LinearLayout并且在构造函数中引用按钮的布局。</p>\n<pre><code>// 类文件\npublic class button extends LinearLayout {\n    public button(Context context, AttributeSet attrs) {\n        super(context, attrs);\n        // 指定按钮的布局\n        LayoutInflater.from(getContext()).inflate(R.layout.button, this);\n        Button button = (Button) findViewById(R.id.button1);\n        button.setOnClickListener(new OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                Toast.makeText(getContext(),\"toast\", Toast.LENGTH_LONG).show();\n            }\n        });\n    }\n}\n// 按钮的布局文件\n&#x3C;?xml version=\"1.0\" encoding=\"utf-8\"?>\n&#x3C;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\">\n    &#x3C;Button\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:id=\"@+id/button1\"\n        android:text=\"button\"\n    />\n&#x3C;/LinearLayout>\n</code></pre>\n<h3>使用组件</h3>\n<pre><code>&#x3C;?xml version=\"1.0\" encoding=\"utf-8\"?>\n&#x3C;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\">\n    // 通过类名使用组件\n    &#x3C;com.example.learnlayout.button\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        title=\"clickMe\"\n    />\n&#x3C;/LinearLayout>\n</code></pre>","fields":{"readingTime":{"text":"4 min read"}},"frontmatter":{"title":"一起学Android-布局","date":"2021-06-25","tags":"跨端技术","path":"/android-layout","top":null,"summary":null}}},{"node":{"id":"ba77ce28-026f-5ccd-b1aa-0cdc90d1fe91","html":"<p>广播是安卓内的消息通知机制，通过接收广播消息应用能收到系统级的消息通知/其他应用的消息通知。</p>\n<h2>接收广播</h2>\n<h3>声明接收器</h3>\n<p>声明接收器是通过在AndroidManifest.xml中声明广播的方式来实现广播的注册。这种方式在应用级别26以上不再支持。实现方式如下:</p>\n<h3>创建broadcast receiver</h3>\n<pre><code>public class MyBroadCast extends BroadcastReceiver {\n// 创建MyBroadCast 实现onReceive \n// 当接收到广播时 会调用onReceive\n    @Override\n    public void onReceive(Context context, Intent intent) {\n        Toast.makeText(context, \"receive broadcast\", Toast.LENGTH_SHORT).show();\n    }\n}\n</code></pre>\n<h4>在Manifest中定义receiver</h4>\n<pre><code>// 定义receiver\n&#x3C;receiver android:name=\".MyBroadCast\" android:exported=\"true\" android:enabled=\"true\" >\n    &#x3C;intent-filter>\n        &#x3C;action android:name=\"android.intent.action.BOOT_COMPLETED\" />\n    &#x3C;/intent-filter>\n&#x3C;/receiver>\n// 权限声明\n&#x3C;uses-permission android:name=\"android.permission.RECEIVE_BOOT_COMPLETED\" />\n</code></pre>\n<h3>上下文注册接收器</h3>\n<h3>创建broadcast receiver</h3>\n<p>同声明接收器创建方式</p>\n<h3>在活动中注册broadcast receiver</h3>\n<pre><code>public class MainActivity extends AppCompatActivity {\n    private MyBroadCast myBroadCast;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 创建广播接收器\n        myBroadCast = new MyBroadCast();\n        IntentFilter intentFilter = new IntentFilter();\n        // 监听网络变化\n        intentFilter.addAction(\"android.net.conn.CONNECTIVITY_CHANGE\");\n        // 注册广播接收器\n        registerReceiver(myBroadCast, intentFilter);\n    }\n\n    @Override\n    protected void onDestroy() {\n      //销毁监听\n      super.onDestroy();\n      unregisterReceiver(myBroadCast);\n    }\n}\n</code></pre>\n<p><img src=\"/blog/fa68f00702cb8da7b73fbba300e8fe32/showBroadCast.gif\" alt=\"接收广播\"></p>\n<h2>发送广播</h2>\n<p>Android提供以下三种方式发送广播:</p>\n<ul>\n<li><a href=\"https://developer.android.com/reference/android/content/Context#sendOrderedBroadcast(android.content.Intent,%20java.lang.String)\">sendOrderedBroadcast(Intent, String)</a> 发送顺序广播，接收器顺序执行可以向下传递结果也可以中止广播。具有相同优先级的接收器按随机顺序运行。</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 978px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/ac9f04546701d76768ab99cd9448a116/614df/orderedBroadCast.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3YFB/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERITH/2gAIAQEAAT8hdI700//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhUaHh/9oACAEBAAE/EKDDyFl8Qdp//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"顺序广播\"\n        title=\"顺序广播\"\n        src=\"/blog/static/ac9f04546701d76768ab99cd9448a116/614df/orderedBroadCast.jpg\"\n        srcset=\"/blog/static/ac9f04546701d76768ab99cd9448a116/0479a/orderedBroadCast.jpg 250w,\n/blog/static/ac9f04546701d76768ab99cd9448a116/41099/orderedBroadCast.jpg 500w,\n/blog/static/ac9f04546701d76768ab99cd9448a116/614df/orderedBroadCast.jpg 978w\"\n        sizes=\"(max-width: 978px) 100vw, 978px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><a href=\"https://developer.android.com/reference/android/content/Context#sendBroadcast(android.content.Intent)\">sendBroadcast(Intent)</a> 发送常规广播，会按照随机顺序向所有广播接收器发送广播，无法从其他接收器中获取传递结果和中止广播。</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 766px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/e518738eb7cc766faf4e21990f038705/d8ebd/normalBroadCast.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6aQgD/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARAxQXH/2gAIAQEAAT8hHtih9Ef/2gAMAwEAAgADAAAAEHDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAIBBQAAAAAAAAAAAAAAAQARMRBRYYGR/9oACAEBAAE/EL4fIlMHUTu6BpSksmWf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"普通广播\"\n        title=\"普通广播\"\n        src=\"/blog/static/e518738eb7cc766faf4e21990f038705/d8ebd/normalBroadCast.jpg\"\n        srcset=\"/blog/static/e518738eb7cc766faf4e21990f038705/0479a/normalBroadCast.jpg 250w,\n/blog/static/e518738eb7cc766faf4e21990f038705/41099/normalBroadCast.jpg 500w,\n/blog/static/e518738eb7cc766faf4e21990f038705/d8ebd/normalBroadCast.jpg 766w\"\n        sizes=\"(max-width: 766px) 100vw, 766px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><a href=\"https://developer.android.com/reference/androidx/localbroadcastmanager/content/LocalBroadcastManager#sendBroadcast(android.content.Intent)\">LocalBroadcastManager.sendBroadcast</a> 本地广播，在无需跨应用广播时使用。</li>\n</ul>\n<p>下面发送本地广播的实现方式:</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n    private MyBroadCast myBroadCast;\n    private String actionName = \"com.example.broadcast.MainActivity.SHOW_TOAST\";\n    private LocalBroadcastManager localBroadcastManager;\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 获取LocalBroadcastManager 实例\n        localBroadcastManager = LocalBroadcastManager.getInstance(this);\n        Button button = (Button) findViewById(R.id.broadcast);\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                // 发送广播\n                Intent intent = new Intent(actionName);\n                localBroadcastManager.sendBroadcast(intent);\n            }\n        });\n        myBroadCast = new MyBroadCast();\n        IntentFilter intentFilter = new IntentFilter();\n        intentFilter.addAction(actionName);\n        // 注册接收特定类型的广播\n        localBroadcastManager.registerReceiver(myBroadCast, intentFilter);\n    }\n\n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        // 销毁广播\n        localBroadcastManager.unregisterReceiver(myBroadCast);\n    }\n}\n</code></pre>","fields":{"readingTime":{"text":"3 min read"}},"frontmatter":{"title":"一起学Android-广播","date":"2021-06-25","tags":"跨端技术","path":"/android-broadcast","top":null,"summary":null}}},{"node":{"id":"cc1921b0-4b50-54b0-aef0-6edd57b971fe","html":"<p>Hybrid开发模式中经常需要依赖端能力来实现业务和技术方案，前端作为端能力的调用者通过对端能力的系统学习能更好的辅助业务开发。这个系列主要是自己在学习跨端技术上的一些记录，文章会偏短小，希望尽可能覆盖更多的知识点也希望能帮助到你。</p>\n<h2>Android项目目录介绍</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 566px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/2922880ba1fa1f5b907f939c9657ebad/6fe44/androidProject.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 177.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAYAAACU9ioYAAAACXBIWXMAABYlAAAWJQFJUiTwAAADdklEQVRIx5VW2W7jRhDk7+QlWCBIbF08dPAcDsnhJa2sWDYiL/Ka/wcqqJZIc3VZ+9AYikMWq7q6e2T5KxeB7yIJl8i2Bj9aHx8vFbSOkapA9vjMo2GlkYs0cpDGLvJkgf/C33Ewc+xeGryscxz3Hw9r4riYOB4mtovRzIF5PSBvtyjKCmPblfuy34d7N6yx7cmLU3cOd+mj2r5ClzXiVAsA9y7DuxlW9xJXe76ErjfImw1inclHZt5CVvu0frL0bjF0MQQdT23oZoP273eoLEdRNzB1i3r9HWWzlg+ML9LwGVZ3IQ+RkTtHvn5Bu9sjVQoqK3pm3fo44Ok6VBpB/R1us0WcZpKKYQ7vgVrnmyPbheN6+DPU+G37L7SpkJf1IH/e14A/5dB2JU9xZvC6a5GoBHM/xF/jqZTV89SWjw4r4CrgObC98KF0jHb3ilgXWEUJ/ChBmKRwFysBv8bWugZ2rEsPzjJAuz9A5UZkF1UjsQrji1x2q3UtD12hU2q7/wdJVkAXJTJTSRnRtLJdI0q1pOCu5CGgtwqx3h+QFqWUD0HZTcxxV/BDuby+CTgTwEAYEpBgsc4vQM7f+4JhgPXbB+ITOxrzNLXxfHJbHJ85Eg/lsAfUheSPxlB6qFL5zZb0YyVGReqYzy8BN28fiNIM2hxlE5BmEIQDhF20DGMppcck7w/iclcyBCVgtd7AWax+kv2QZJoSpblIZKS5QRArlM1R7sMuDwHpbl5WyMoKKi8EsGo3Uo+jmfsrdXhiqD8ZsmuCRMHUjbC923rXXT6IKT1gVohU5pID1xn09QOSQwGMO4ZlJUCUypWyE53/IsP9AaEwLKV0OG3Y42RJYBb744Cn4UCGujDSguxhzsanyawvmavT5tx+6eWFj837j94UAtIQlgwl8zmCDkeYdT7TxjwG2JveHH5dQbE7ciMApmnFFJqRFgaLIJKh65y65DpDHvjzFSYqxrd3gyjLkQnocUB0LUjA6GSOu7wBKKNp5qDY7LB5OyDNcmHxx9NIpDFvw+jujc4l9yfe6ZDnuOIhzzJhHwdnLXbLyAuXmTtVtsiqVlzluKdU1hon9S2Qu4dUYpqjEWTJvJlS5h5z9jx1+lK5deBfMORfOV02UsgcV3lV9zOQwHK2mPLmYX/BcBkpGZjLIJKuoCmUy67hNe+zU24B/g8mjevg4YzNMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"安卓项目结构\"\n        title=\"安卓项目结构\"\n        src=\"/blog/static/2922880ba1fa1f5b907f939c9657ebad/6fe44/androidProject.png\"\n        srcset=\"/blog/static/2922880ba1fa1f5b907f939c9657ebad/63868/androidProject.png 250w,\n/blog/static/2922880ba1fa1f5b907f939c9657ebad/0b533/androidProject.png 500w,\n/blog/static/2922880ba1fa1f5b907f939c9657ebad/6fe44/androidProject.png 566w\"\n        sizes=\"(max-width: 566px) 100vw, 566px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>build.gradle 项目模块的构建脚本</li>\n<li>res 项目的资源目录 存放布局(lagout)、图片(drawable)、图标(mipmap)、字符串(values)等</li>\n<li>AndroidManifest.xml 项目的配置文件(组件声明、权限等)</li>\n</ul>\n<h2>活动创建</h2>\n<p>活动是一种可以包含用户用户界面的组件，通过活动可以实现与用户的交互，在Android开发中创建一个活动的过程如下:</p>\n<ul>\n<li>创建活动</li>\n<li>创建布局</li>\n<li>在活动关联布局</li>\n</ul>\n<p>以下的例子以创建一个展示可点击按钮的页面为例子来展开活动相关的知识点。<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/821bbbd1c5b9eac1daa223540e7913f0/ab98c/create.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABzklEQVQoz1WSS0/bQBSF/WsISUqICRD8iGfGr7HHEzt2MFVbqV1U6qYUELDpor/9qzJAVRaf7lkd3XPu9aL2lsv2kXP7wIV9YGXuWZk7zsw9vv5B1Vp2naUyGpEq2l5xPcaMY8DNGPDx+orrfs2uW9N3azxte1TZIIsGVVoiVRLK0k1Z1PT7kXYYsbsBkRVEyYpE+MSJj0h8yvSMKFyyXC7w/QVevW3JdUWUCMJEEAnp9EZK0lJjh5GiMsQyReYl8/mCydGU4+MZk8mUo8mLnk5f8HTTst0NJGlOJJQjTJQzKKoGawd0Y5GH7YRicXrKfD5jPp87PrzON7zSNOS6JlGZM/mHSImVQrcGY7eovHAJThYLZrPZO5P3hnVD0+3Iyopgc4gtHZtDxEJT72+w/Q2brCaQBSenS2f4xvQ/fcDLm4batmS6dpse+lKFJlEpUlvkl2eS4YmV+cV5c0ugSuJNTBCFhFFEGL8SRVxcXuLlW4PtekzbuS7bYU/T9eRljShLsn1PZVqCRJGkhTuSGT6T2xFZDQ5R9Qjds05KPG0aZ1jUho3K3GscDhQLxZUQ5ENL/lqHzDOG74+Yr3/IP/0m2D3hVz8dZ+aOZfaNv/WJPU3ARy2aAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"创建活动\"\n        title=\"创建活动\"\n        src=\"/blog/static/821bbbd1c5b9eac1daa223540e7913f0/00d43/create.png\"\n        srcset=\"/blog/static/821bbbd1c5b9eac1daa223540e7913f0/63868/create.png 250w,\n/blog/static/821bbbd1c5b9eac1daa223540e7913f0/0b533/create.png 500w,\n/blog/static/821bbbd1c5b9eac1daa223540e7913f0/00d43/create.png 1000w,\n/blog/static/821bbbd1c5b9eac1daa223540e7913f0/aa440/create.png 1500w,\n/blog/static/821bbbd1c5b9eac1daa223540e7913f0/e8950/create.png 2000w,\n/blog/static/821bbbd1c5b9eac1daa223540e7913f0/ab98c/create.png 2356w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/24def/createdetail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjElEQVQ4y62UaY7bMAyFfaY2E9uSRVHU5tjJLJk0aYECvf8pXiE5zXRJOggwPz6QAIUn8mlpUhDY7OFDhgsRhh3IScWwgH1EzJvKUpdL/RpNOxDYJ6RpRhgnkAQoYvTESzQW3UCVkvfn2t+oM01ZZCVi2j0hbbZV0LCvDO4N8w4Dy1nQWsizw/bbjPGYEfcBYS/g0cNLQPAB3oc6ur1FscL5RVAJgWdGylv4vAG7BMoOnA2OWuFgFF6MhrMWygoG66BvsAgywX9lPP7YYv6e4Q8MfzKQnUAkQUKEDxEuJPAtYnrrUDuCO1rELxHxIOAnAr0oUDLYKY3XocNJt3CG0JG7mH+N0mXTk61+Ta+P2Ox3GPc75OcZnOJl93cJpUP585TjOCOkCeQiNBWvpJ7cPVwEh3IpJUCzu1vkH8H/eXIv1cNfyUegqqCxH9ShrTSauM5fdymx5rd9Kl7X5/n70ys1P0JLRvPQKzx011m1PVZth89tt8R1e/6BAlql0aoB615j3St8iieswgE/AbStDGQ+zRPuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"创建配置\"\n        title=\"创建配置\"\n        src=\"/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/00d43/createdetail.png\"\n        srcset=\"/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/63868/createdetail.png 250w,\n/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/0b533/createdetail.png 500w,\n/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/00d43/createdetail.png 1000w,\n/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/aa440/createdetail.png 1500w,\n/blog/static/4205cc3a58e8ca0d0e94d2f514ea1643/24def/createdetail.png 1812w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n上面在AndriodStudio中创建了一个空的活动并且同步创建了布局文件，设置创建的活动为应用的起始活动。<br>\n通过查看代码Android Studio已经自动帮我们完成了布局与活动的关联。<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/c6162/activityShow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKElEQVQY013Py07CQBiGYS5HOp3SMj1PD8O0ELGcQpDElS5caHSB8f7zGgfE6OLJN6s384+O+4HtZknXtcx7Q//PfG4ws4Y4TkgmHpNA4kuJlD7SF0gZIKXE932E8Bit1gOr9QpjLbPOuv01w3SWum3J05Q0HKNCQRhNXTjyb9w7mirCaHIOttYwbNaYWUuhC3RV/lWXlFVJGOdE4RhbjNGZoq5yCt2QF9r9/jsshM9I3b6Q7T9pjh/Yw4lydyId3lHL17O7N+L5IypJCYKAWCmyLCfNcpIkI1EZahpfzx6l3QG7fWJxeKZePpD1x4v7iyOp2TKNE4KJRAjhTvM8z+2ZcDEXLCuN7Tt2m4F+saAxLbqu0E3ltmoqCq0JI+Ui55BwPO+Hd/UFOznJQaz4eeQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"布局与活动的关联\"\n        title=\"布局与活动的关联\"\n        src=\"/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/00d43/activityShow.png\"\n        srcset=\"/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/63868/activityShow.png 250w,\n/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/0b533/activityShow.png 500w,\n/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/00d43/activityShow.png 1000w,\n/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/aa440/activityShow.png 1500w,\n/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/e8950/activityShow.png 2000w,\n/blog/static/fff1236399c2d5248cbe9cfc9e1baa53/c6162/activityShow.png 2166w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n在AndroidManifest.xml中已经自动完成的活动的声明。</p>\n<pre><code>&#x3C;?xml version=\"1.0\" encoding=\"utf-8\"?>\n&#x3C;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"com.example.myapplication\">\n    &#x3C;application\n        android:allowBackup=\"true\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.MyApplication\">\n        // 活动声明 Android Studio在创建活动时候自动在ManiFest文件中完成声明\n        &#x3C;activity android:name=\".MainActivity\">\n            // 定义为启动活动\n            &#x3C;intent-filter>\n                &#x3C;action android:name=\"android.intent.action.MAIN\" />\n\n                &#x3C;category android:name=\"android.intent.category.LAUNCHER\" />\n            &#x3C;/intent-filter>\n        &#x3C;/activity>\n    &#x3C;/application>\n&#x3C;/manifest>\n</code></pre>\n<h3>实现按钮逻辑</h3>\n<h4>在创建的layout布局文件中定义一个按钮</h4>\n<pre><code>// activity_main.xml\n&#x3C;?xml version=\"1.0\" encoding=\"utf-8\"?>\n&#x3C;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\">\n    \n    &#x3C;Button\n        // 宽高定义\n        android:layout_width=\"wrap_content\" \n        android:layout_height=\"wrap_content\"\n        // 定义按钮的id 可以在活动中通过id查找到对应的按钮\n        android:id=\"@+id/button_1\"\n        // 按钮显示文字\n        android:text=\"clickMe\"\n    />\n&#x3C;/LinearLayout>\n</code></pre>\n<h4>在活动中实现按钮的点击操作</h4>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 通过id查找到按钮\n        Button button = (Button) findViewById(R.id.button1);\n        // 定义点击事件\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                Toast.makeText(MainActivity.this,\"hello\", Toast.LENGTH_LONG).show();\n            }\n        });\n    }\n}\n</code></pre>\n<h4>通过模拟器查看效果</h4>\n<p>通过ADV Manager创建模拟器<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/a01dc/createVirtual.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+0lEQVQ4y31TW07cQBD0efKDQkISGz/m/fRjDRIEdk02UnKNSPnLCYjggwNwyYp6WO8uKzYfpemZ7il31bQzNzpIqSCVhlQKQipoYxJ8iFiMI4bFiPHiEs6HTc4eRfbn6Rmrm2ssl0tM0wrTNGEYBsQQEGNA8D7Be785i/9FNq1/pqDtOnRdj34YEEKEcx7O7+CPxIfIhDZQNkC7AOMjSiZQ1AznDX8TlMur5mhNpowGVwq27WFCC2k9pAtQPkJQbD2UC+mMaQuhLWxswZR5kzTj4QqFILMVuGComyqtQnEIySGVgLYKxmowISCNS0pqoVBxgYrLLRLh6bdnnAy/wbo7FOE7zvQKn8wKX+wK52GdUMU16u4Hav8VsR/QjReJkBQR+WwFISM5OQ/Ip3uc3j7i3eU9Tq7/4uPyAe9vHvDh9gGfp0ecTU8or35BGQMbu2QFyebabglTh9I61FxAao2aNSirElVTpZgJBi45hJIJJDl0A+KwSBLpcfIDH7P5VemLwngUNU+gJFN22wXXDiWTaQqIbP9BiortJJMXyQ8fE2kjdcJMNMdzbn9k5pXOiSN16NoeBO1jInjZd2mdO5kVHI4KxVRD9eQrxVnyYYN5aPf3u8vNlvw1GuRlva3PXv0ZBwbvX5xJmdLwXY+GrOICRVwib+9Qb2bxH4ZY+0FYxaAIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"创建模拟器\"\n        title=\"创建模拟器\"\n        src=\"/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/00d43/createVirtual.png\"\n        srcset=\"/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/63868/createVirtual.png 250w,\n/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/0b533/createVirtual.png 500w,\n/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/00d43/createVirtual.png 1000w,\n/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/aa440/createVirtual.png 1500w,\n/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/e8950/createVirtual.png 2000w,\n/blog/static/d0885da6b36b793e8aaed04e8dcce8bc/a01dc/createVirtual.png 2006w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n在模拟器中启动项目<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/df2f9e33e2c539487abb53bf56f18a06/ab40b/launch.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAhklEQVQI1x3FWQ6CMABAQe5DLYu0bK2ytAiSEA2oyP3v8Uycnwk6P+CGgab3eO9px4lmnnDPF/P24bF9Gdc7drFcF8PWl+yXmrWzHK3lcB3uNlL3nvW9E+RaYVSE1jllWVGUNUVRoU1DWliS3BClChkLZCxRQqBF+F+JkEyERCdBmkiSc8YPbOhEx60iQJUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"创建模拟器\"\n        title=\"创建模拟器\"\n        src=\"/blog/static/df2f9e33e2c539487abb53bf56f18a06/00d43/launch.png\"\n        srcset=\"/blog/static/df2f9e33e2c539487abb53bf56f18a06/63868/launch.png 250w,\n/blog/static/df2f9e33e2c539487abb53bf56f18a06/0b533/launch.png 500w,\n/blog/static/df2f9e33e2c539487abb53bf56f18a06/00d43/launch.png 1000w,\n/blog/static/df2f9e33e2c539487abb53bf56f18a06/aa440/launch.png 1500w,\n/blog/static/df2f9e33e2c539487abb53bf56f18a06/ab40b/launch.png 1736w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n在模拟器中点击按钮展示了Toast<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/a8d23e69732946a44dc47941ae242238/c5bb3/showContent.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 188.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAmCAYAAADEO7urAAAACXBIWXMAABYlAAAWJQFJUiTwAAADiklEQVRIx+WWXWgjVRTHry5UKWupTVptaTKZfE0+JpNMktpKV4UVLWVd1rYsuqtik3Z3FSzoqqB1fdg+CT5scXXFF/vW7y7ig68iu/skFfWlIvWl9aGvhdBkmo+fzMSEpKS2Ql0KXvjPuefMub97zzAz94rJyUmCwSDJZBJdT6DrOrGYjqZF0TSNSCSCqqqEw2FCoZCVGwgELCmKgt/vx+Px4PV6mfl6BpGIJ4nHe0iY0svQWDSO4g/g9ZjJPtxuL27Zgyx7cEkyXq+fgBLC51Osvs/nR3K6UPwKItmjE0uoxOJhtFiIiBYgEg2i6aZVCGs+QhEvQdVDIOwmEHKjBF14FScevwPZ041D6kKSu3DJEuIJ9Qyn1NfoVy/ydOwiz8RfoV+9QNx1Ht11nphzhKhjBM0xjNY9RKR7CLXrRcKd5wg+dhbNcY4+dZiEZxi/rCGef/wzXm/9g1fbfuWyc423lN+5LK3xnPiRF8TqvjorfuKMWGXkoZ95W/uNdyN/knS+hHjZtsR1O0zadvioLcc1e45rthxTToMPThq880COqydyXH2wgU7krPsTIsN7AvrsKcSFjkVu9sCn+g63ThtMP2kwJeX4JJTj/YezXBE7vCmyvLGPyvcyTAjoeTSFmDi1yBf9cOOpDNP9O9w8neX7GwY/fG5w55bBva92uXuA7nyZZXUGhp5NIUZOLvDxI3Bd2mHKWS65WCjx71rBul66kkZMf7jM2jewOm+wOpfnl9t5drMlC1rIlygeQrtGGZgaTSO+/e523SyVViqVqvYgFQrlselUCrG8tGI55iyVGWthB7VaYGp0FLGyUgaawcMA7i/QKnl5+ciA1jNcWlo6vkCr5MXFxeMLtEpeWFg4WuD8/Pz/CZhOI+bm5o4MOHbUwPR/ApydnT2+QOtLuS8rrPzaG20Be//khwbutwXsjdW9NmNj+5dc6ReLRatfsf+0wjpgPp9vuKNtb2+zvr7OxsYG2Wy24WOoA9a+h41aJpNhc3OTra0tDMNovM3/PXZ8L9CczVxpowFmybXN9CsrrgAvjY8jZNltHWndbrd1rO3t7a36ppUkib6+PqLRKC6Xy4qZ1jwmDw4OVmNmvluWEU1NTQghqjLP0bW+qXA4hM1mq4s1NzczMDBQF2tvb0d0dnZit9stx7QtLS1Wv+y309HRYcVaW1urOaZta2uzoJVcm92G5HTyF7kXnrJ/9jLzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"展示效果\"\n        title=\"展示效果\"\n        src=\"/blog/static/a8d23e69732946a44dc47941ae242238/c5bb3/showContent.png\"\n        srcset=\"/blog/static/a8d23e69732946a44dc47941ae242238/63868/showContent.png 250w,\n/blog/static/a8d23e69732946a44dc47941ae242238/0b533/showContent.png 500w,\n/blog/static/a8d23e69732946a44dc47941ae242238/c5bb3/showContent.png 680w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>活动之间交互</h2>\n<p>在应用中不可避免的需要不同的活动间进行跳转和数据交互，可以通过Intent来实现活动之间的跳转。</p>\n<h3>使用显示Intent跳转</h3>\n<p>通过Android Studio创建testIntent活动，在testIntent的layout文件定义文字方便识别跳转.</p>\n<pre><code>&#x3C;?xml version=\"1.0\" encoding=\"utf-8\"?>\n&#x3C;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\">\n    &#x3C;TextView\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:text=\"测试显示intent\"\n    />\n&#x3C;/LinearLayout>  \n</code></pre>\n<p>在MainActivity中使用intent实现跳转</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 通过id查找到按钮\n        Button button = (Button) findViewById(R.id.button1);\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                // 显示的创建intent 指定当前的context MainAcxtivity  目标活动 testIntent\n                Intent intent = new Intent(MainActivity.this, testIntent.class);\n                // 启动活动\n                startActivity(intent);\n            }\n        });\n    }\n}\n</code></pre>\n<p><img src=\"/blog/3a02576763653fa6a4f4d24e087e0108/intentJump.gif\" alt=\"显示Intent跳转 \"></p>\n<h3>使用隐式Intent跳转</h3>\n<p>区别于显示的Intent跳转，隐式Intent通过定义action和category信息让系统查到对应的活动实现跳转。<br>\n创建testIntentImplicit，在ManiFest文件中声明action和category</p>\n<pre><code>&#x3C;activity android:name=\".Implicit\">\n    &#x3C;intent-filter>\n        &#x3C;action android:name=\"com.example.myapplication.TEST_INTENT\" />\n        // 必须添加DEFAULT category 否则会导致通过startActivity和startActivityForResult无法识别正确的activity\n        &#x3C;category android:name=\"android.intent.category.DEFAULT\" />\n        &#x3C;category android:name=\"com.example.myapplication.TEST_INTENT\" />\n    &#x3C;/intent-filter>\n&#x3C;/activity>\n</code></pre>\n<p>在活动中创建隐式Intent</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 通过id查找到按钮\n        Button button = (Button) findViewById(R.id.button1);\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                Intent intent = new Intent(\"com.example.myapplication.TEST_INTENT\");\n                intent.addCategory(\"com.example.myapplication.TEST_INTENT\");\n                startActivity(intent);\n            }\n        });\n    }\n}\n</code></pre>\n<p><img src=\"/blog/edd3089ae16056b202f01de5ee7157ae/implictJump.gif\" alt=\"隐式Intent跳转 \"></p>\n<h3>传递数据给下一个活动</h3>\n<p>可以在intent中通过putExtra中传递数据。</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        // 通过id查找到按钮\n        Button button = (Button) findViewById(R.id.button1);\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                Intent intent = new Intent(\"com.example.myapplication.TEST_INTENT\");\n                intent.addCategory(\"com.example.myapplication.TEST_INTENT\");\n                // 在intent中增加数据\n                intent.putExtra(\"extra\", \"传递数据\");\n                startActivity(intent);\n            }\n        });\n    }\n}\n</code></pre>\n<p><img src=\"/blog/8d5dedf2170474f96abae68c68fb9d50/deliverData.gif\" alt=\"传递数据\"></p>\n<h3>传递数据给之前的活动</h3>\n<p>通过startActivityForResult和onActivityResult可以实现传递数据到之前的活动。</p>\n<pre><code>protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n    // 在onActivityResult中判断requestCode是哪个activity返回的结果\n    switch (requestCode) {\n        case 1:\n            if(requestCode == RESULT_OK) {\n                String responseData = data.getStringExtra(\"extra\");\n                Toast.makeText(MainActivity.this, responseData, Toast.LENGTH_LONG).show();\n            }\n            break;\n        default:\n    }\n}\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n    Button button = (Button) findViewById(R.id.button1);\n    button.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            Intent intent = new Intent(\"com.example.myapplication.TEST_INTENT\");\n            intent.addCategory(\"com.example.myapplication.TEST_INTENT\");\n            // 通过intent和requestCode打开活动\n            startActivityForResult(intent, 1);\n        }\n    });\n}\n</code></pre>\n<p>在跳转的活动中通过setResult返回数据给之前的活动</p>\n<pre><code>@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_implicit);\n    Button button = (Button) findViewById(R.id.buttonBack);\n    button.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            Intent intent = new Intent();\n            intent.putExtra(\"extra\", \"数据返回\");\n            setResult(RESULT_OK, intent);\n            finish();\n        }\n    });\n}\n</code></pre>\n<p><img src=\"/blog/af74a5d1e5ef0e39f1fdee8fd10ca82d/resultBack.gif\" alt=\"传递数据\"></p>\n<h2>活动启动模式</h2>\n<p>安卓使用栈来管理活动的层叠关系，系统总是将位于栈顶的活动展示给用户。在声明活动时，可以定义活动的启动模式从而影响活动在栈中的表现。<br>\n通过在声明activity中android:launchMode定义活动不同的启动模式。</p>\n<h3>standard</h3>\n<p>standard模式是默认模式，在standard模式下创建新活动都会在栈顶新增一个活动入栈。<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/99d8f33acd23780a98ec21f4c4b832c9/5a3c9/standard-mode.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVQY01WRiQqEQAxD/f+PFO9b1xsPNMsrdGGFSjJNM20nuO9by7Jo2zZN06R5nvX5fLTvu8ZxNE6e3DAMxjlHA+YcTlzXpWBdV9V1rbZt1fe9mqZRVVVWwHmapsqyTEVRqCxLy4Odo3HOBQG/53nknRJw7ySOY0VRZIVozvM0U773fU1zHIdx8J8hGHGSJL8uMSTohvCcG/p6fobsIM9zE4EpYkw4O/OR0bgh43VdZ5w1/RkyYhiGJiTBaIzITumY7shhgCkczEXU0aE/HvgLUSrFo8BPpOEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"standard模式\"\n        title=\"standard模式\"\n        src=\"/blog/static/99d8f33acd23780a98ec21f4c4b832c9/00d43/standard-mode.png\"\n        srcset=\"/blog/static/99d8f33acd23780a98ec21f4c4b832c9/63868/standard-mode.png 250w,\n/blog/static/99d8f33acd23780a98ec21f4c4b832c9/0b533/standard-mode.png 500w,\n/blog/static/99d8f33acd23780a98ec21f4c4b832c9/00d43/standard-mode.png 1000w,\n/blog/static/99d8f33acd23780a98ec21f4c4b832c9/5a3c9/standard-mode.png 1169w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>singleTop</h3>\n<p>singleTop当栈顶是要打开的活动时，不会创建新的活动实例入栈。<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 807px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/80638bb8d399426618fcc157771016a9/d2a60/singleTop.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQoz52R2a6EQAhE+///UOO+7zqORkcnYXJI8OE+3k5IA10UBe0+n49g13X9y6zWeJw9pGkqr9dL5nmWIAhkGAbNVVWl+bIsJYoiadtW89xhGErf95JlmWK+36+49/utyWma9B7HUTtRAClG7jiOJ8bA0rwoCrU8z2VdV3GAz/MUzn3fSkwxYDvLsqihwg7FqMYgS5JEGzkI/hKisK5rBXRdp2MzCT5EEOMzBWSsAEJqnRFw2IHFdG6a5lGwbdszHrvjtnfIIGVax2jsg0dU4fNJLNqAvEGIUjCQQYRK2x84VQghged54vu+FjB6HMcKpJAcIxNDQCN8I8fg0B2yP1NJYt93VYhPAar4EHIosI8wLOrBcBP/AMUep4pPDBSjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"singleTop模式\"\n        title=\"singleTop模式\"\n        src=\"/blog/static/80638bb8d399426618fcc157771016a9/d2a60/singleTop.png\"\n        srcset=\"/blog/static/80638bb8d399426618fcc157771016a9/63868/singleTop.png 250w,\n/blog/static/80638bb8d399426618fcc157771016a9/0b533/singleTop.png 500w,\n/blog/static/80638bb8d399426618fcc157771016a9/d2a60/singleTop.png 807w\"\n        sizes=\"(max-width: 807px) 100vw, 807px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>singleTask</h3>\n<p>singleTask会复用栈内的实例，如果栈内已有实例会把实例之前的活动全部出栈。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 659px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/811c885983b4a1125c7429765cb91547/6db71/singletask.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVQ4y52T144CMQxF+f9fQ7zxgOh96HXoxehc6WaDtC+7ljzJOPFxSVK53+9xu93i8XjE8/lM8/f7rdH2fM4ao9UMxgqT1+sV+/0+1uu1nMqyjMlkErvdTvbVaqXxdDppnE6nGrfbrdbO53OCCsjG8Xgc7XY7bep0OjGfz2XvdrsxGo1kXy6XWsOOjTl2EhEQGNkcj0eBF4tFbDabQHAmwOFwULaz2Uzlsg8IdvwIzBxoBQNOFqK4dAC5AGHdZVoIAENA+gXAwkb+aTbZ4owCp0ycWAdicVIJ6BKR6/X6BaQcDqHf78dgMJCd9TxDGF9AHC+XixR4DhwOhzqUZrOZgOyhZ2QJmP6iAmLo9XrKpCgKOXEYCHNKJUMUOEBaQPlkRXBOm2skIFEcHXCr1RLcQILgwE0wkIBkTRvwYZ6AnBobcHAmtMG9AgqIkUA4+aoRCCXb9FL44MxrQfOn5Kdm9T+lEsQXn2CA00v5TQ3NlRvgkmu1WlSrVWm9Xo9Go/GT4V/UcN8C+keg9PT+A8xbQpvyQB8SmXvzI+bD0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"singleTask模式\"\n        title=\"singleTask模式\"\n        src=\"/blog/static/811c885983b4a1125c7429765cb91547/6db71/singletask.png\"\n        srcset=\"/blog/static/811c885983b4a1125c7429765cb91547/63868/singletask.png 250w,\n/blog/static/811c885983b4a1125c7429765cb91547/0b533/singletask.png 500w,\n/blog/static/811c885983b4a1125c7429765cb91547/6db71/singletask.png 659w\"\n        sizes=\"(max-width: 659px) 100vw, 659px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>singleInstance</h3>\n<p>singleInstance会创建一个新的返回栈来管理活动，主要用于不同应用间活动的共享。在下面的例子中从活动C返回时会先返回到当前栈的活动A在返回到活动B<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 990px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/812d44b27c3de2c4bfb00faf3973642c/7a3d6/singleinstance.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVQoz02SVwrEMAxEff8T5iOQ3nvv0fIEXmIQstpoLNmc5ynHcQh633fZtk3WdVX7ui71ockhZuMIPuJoK4bCpmmkqioZx1HatpU4jqUsSwmCQBzHkaIopO97zeu6TjU+QPM8l2VZ5L5vbWxIQIZh0CKSrJ1lmRbQBBBbSIzm5BH7Yijg+77CsYmAcrjj4/ASbHRd1wo8TZMyhRkCuIEVSc/z/AHnedYm2DBM01TZ4ieXUYRhKEmSKHOAYQ85gwMBiDkSsDNDA4SmGECYABZFkTaihgYIOAb6ruuK53lazHN931eb5QDEHbEMuX9B0fgAN6wdyjDkS7B6O2x8dvP4iNtZ8QtgxEsggrCUH8gQYLYhbGLGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"singleInstance模式\"\n        title=\"singleInstance模式\"\n        src=\"/blog/static/812d44b27c3de2c4bfb00faf3973642c/7a3d6/singleinstance.png\"\n        srcset=\"/blog/static/812d44b27c3de2c4bfb00faf3973642c/63868/singleinstance.png 250w,\n/blog/static/812d44b27c3de2c4bfb00faf3973642c/0b533/singleinstance.png 500w,\n/blog/static/812d44b27c3de2c4bfb00faf3973642c/7a3d6/singleinstance.png 990w\"\n        sizes=\"(max-width: 990px) 100vw, 990px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>生命状态&#x26;周期</h2>\n<h3>活动的状态</h3>\n<table>\n<thead>\n<tr>\n<th>状态</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>运行状态</td>\n<td>活动处于栈顶</td>\n</tr>\n<tr>\n<td>暂停状态</td>\n<td>活动不处于栈顶，仍然可见。系统一般不会回收</td>\n</tr>\n<tr>\n<td>停止状态</td>\n<td>不处于栈顶，不可见 可能会被系统回收</td>\n</tr>\n<tr>\n<td>销毁状态</td>\n<td>从活动栈中移除</td>\n</tr>\n</tbody>\n</table>\n<h3>活动的生命周期</h3>\n<table>\n<thead>\n<tr>\n<th>方法名</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>onCreate()</td>\n<td>活动第一次被创建时调用</td>\n</tr>\n<tr>\n<td>onStart()</td>\n<td>活动由不可见变为可见的时候调用</td>\n</tr>\n<tr>\n<td>onResume()</td>\n<td>活动处于栈顶运行状态</td>\n</tr>\n<tr>\n<td>onPause()</td>\n<td>系统准备去启动或者恢复另一个活动时调用,通常在这个方法中进行资源的释放和数据保存</td>\n</tr>\n<tr>\n<td>onStop()</td>\n<td>活动完全不可见的时候调用</td>\n</tr>\n<tr>\n<td>onDestroy()</td>\n<td>活动被销毁之前调用</td>\n</tr>\n<tr>\n<td>onRestart()</td>\n<td>活动由停止状态变为运行状态之前调用</td>\n</tr>\n</tbody>\n</table>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/68bd569be2bf11e6e04ed1f219a48dd0/267f6/life-cycle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 129.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAGPklEQVRIx5VVD2xV5RU/7/W99pWREJZsKg6r0+CAEZWMJsahW1xRXJ1xkRSKS4VCMVtmgkAEpiUbmwwyaGnLWq0+KFSrUKSAtAhY+gdbCu//6yu8///un3f/fvfed9+9bSn9lvt0nZotsl/y5XxfvnN+53znnJwP4FvocCjQ2sdDQ3d61qfByd2nfNK7J93CoXPBiZbjbnVxV0CHrlHdBHeKunMp83tD41Dfwyxpd07gPR878Z/eu4ztwzI+cm3izQ+9GI5c0wvg/8Fdy6oBdmHT1g7uhW3H4pu2tEU2bj8hVFU1xX/4x7YMvNZGg8vlAo7jQBCEmWWcvw7jGZbfPF9uxRjD4EDfY5rCX44F/b0B7/XPsyIzpCriOjw9ATQRNy9atBhkSTIPDPSbmxoPmQcHh82appnBZrPl2WbPnl1os9lspaWlVuN85szZ+RmW3+LxBbYPDV/bTlLMDlnJln4xNAyGw0ceeRQkCcHw1WE4dvQYjIw4IJfLAfyo5H547GelBocFAMzGxu12gyiKD0qS1H3zxo0LLrf7vCiKl8Ph8DqDbPny5dY1ayqLBUE4Go/HXF6Ptz8eT3gQQs356Ox2e96rsQ4cbM7LRCJ5jyxLf74xFnh7ZOTa3xBCe6LR6NPGXXl5eUFV1StWnudfj0Yj9b29vY2RSKwRIfR7w7iQ59grDMOoJEFMCjz/QSSehAxDP8SymVNOl/OM2+08TZDpnkgk9DuDcNWqVUXGa4wieDzufABjYzdBlmWAi0sBBEl5I5pMvR+OxdtYRV9PjHpBZNT5Ije+L+CP1Ps8wTqakBvIlPiMYVz75u4Ck8lU1NHRYVGySsGKFSuKXS6PRVVVM+g9jUv5Mweb6E8O7Ge66g5me5p2446m7226ZC0aoCt2fhp4qf4T14sHBjOV+85FVi788GpZPiIAKPyqMwwUzfSKfuKtnWL7DnxlzwbsbfgD1k7U4qnmnQ/+ZfDn9/VGqvHh87/F9R/9GnePvoK7x17eMpDaCPREV+FzK1cWt7S0WL6iKSwpKflyd3Pfmrtu26vXhveu2kDWVdZoreufNyIg6FTJoNfeNOD959F+T/PhK/7Wo75Qb5kj2AnBsehMEf1+P8ydO/c/EYqBIdD77ICVq4DZPpB6mkBVZBjX9a1MRsAZStTINKfTlIAVWe3BGJsEnl8bi0U3MgyzFmM8BwAKHA7Hl4RI4JdNqvIvODL5tMIzv8xJ4q8QQvfrun6vrIjrb4YCmzw+5yaWp2uyWXnpuD4xP0PT0+l0GhMEgTHGPzUizWSYfA+DLMkcSZA4mYjjRCKBOY7HkizbL1y4+GNRFMOjo4FRh8PpY1k2SVHUa4ax1+tZ4vP7FyOEHlJVtXjBgodt1687CqaNYmGMn8wqyrOhUOi5cDj87NTU7XKM8UJBECwSkuopij6fSqVOi6J4UtNyC0VRAJ7ngOU4kBCCUCiUz2UgMAYiQnlCCAWDM0mOxeJ5eenSJZAkqZ0giIl0Oi1QFB3BGH/fMMIYW6LhMGhabhnDMHaCIN4hSfKwpukLjJFjNhJdXl5uKysrK25vb7fOmzfP7HK5fiBJUqXf76txOJw1oiCsS6ZSSwxndXV1hYZEovgSSZG3EomESBDk+K2p2098fXwZSS2sqKiwGcoXLl4sURTlRigUHHM6XX4kimmKovLDYfPmzbMAwFpUZLOWPPCAdfasIst/HayGMsuyhlycy+U6GYbpZRi2j+O4Poqie7PZ7OcY49U8zxs6ptWr10Brayu0NB+aSdk3EAkHzeO6Brms8iRJUUQkHHGGQmF3KpXyxKLxkVQqzUiSXCsrCiSSScu2bdvg+PHj0NnZCRKSYeLW1DcJA+E0SEg0KYoMDMPerUhoe8Dv2+Vxu3aJAr8LicITmqqCjJDJG/B891+iaTqwHG9Ckgwcx/+ER/IXbl9gcMTl60/RrBPJSrWq6cZ0MmfV7HcTTk9PQ6zxVfj3+J7sP/IUebb55fiphko89MELkfa/ziGO1QJ/cl9e944gfVRrVj5+C6jDWxdN9+zHgdYdePjg6zjbtRdPnn77DfzZfpg8u/fOv1G6aR1kWmog0bB+Dmqpbov/o7I7+PeK00xjVY/cWvO4bn8VpHc2mP8Xwb8ALx5OZ/sHMjIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"生命周期\"\n        title=\"生命周期\"\n        src=\"/blog/static/68bd569be2bf11e6e04ed1f219a48dd0/267f6/life-cycle.png\"\n        srcset=\"/blog/static/68bd569be2bf11e6e04ed1f219a48dd0/63868/life-cycle.png 250w,\n/blog/static/68bd569be2bf11e6e04ed1f219a48dd0/0b533/life-cycle.png 500w,\n/blog/static/68bd569be2bf11e6e04ed1f219a48dd0/267f6/life-cycle.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","fields":{"readingTime":{"text":"9 min read"}},"frontmatter":{"title":"一起学Android-Activity","date":"2021-06-17","tags":"跨端技术","path":"/android-activity","top":null,"summary":null}}},{"node":{"id":"a6a5440d-d3c4-53cd-b6fa-cea42b582ce3","html":"<p>在<a href=\"https://icantunderstand.github.io/blog/webpack-tapable\">深入浅出webpack-Tapable</a>源码解析中,我们了解到webpack是基于Tapable来实现打包的任务调度,本文基于webpack的源码梳理打包的实现流程.在源码分析中会主要关注以下几点:</p>\n<ol>\n<li>webpack启动过程(compiler compilation的生成过程)</li>\n<li>入口文件的解析过程</li>\n<li>loader调用过程</li>\n<li>plugin的调用过程(webpack实现任务调度拆分的方式)</li>\n<li>文件的输出过程</li>\n</ol>\n<h2>前置知识</h2>\n<h3>Tapable</h3>\n<p>webpack基于tapable来实现任务调度和代码逻辑的拆分.<a href=\"https://icantunderstand.github.io/blog/webpack-tapable\">深入浅出webpack-Tapable</a></p>\n<h3>webpack基础</h3>\n<p>webpack是前端的打包工具,通过loader实现了文件转化能力、plugin实现了打包阶段的介入能力(编译能力增强,任务拆分).<br>\ncompiler在webpack启动编译后生成的对象,它负责把控整个webpack的打包构建<br>\ncompilation对象是每一次构建的上下文对象包含当次构建的所有信息.</p>\n<h2>源码解读</h2>\n<p>以下源码解读基于webpack当前master代码.我们在webpack源码下创建如下的目录结构:<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 443px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/6f91bb1c3d81745f56fc1e823c17e799/a120c/debugCategory.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVQ4y6WT626bQBBGeZMmwF5YWHNZLsvFxnaiREr/pO//MKdakjRK1TqO8uNoAA2HD2aI8rxgXU88P//i6eknznXEcYoQ6iKhz7l2q2VZU1U187wn0jpDqYz9fuX+/gFry02YppIkEVcRem9vE5qmfRcG+/l8R0j81vQVgrDr+hehlJq6dizLgTy33NzEHxL+ffO/rgVh2/ZEIZ3WZjvxfmIYPMZ8PeUHYWBdj0zTwuFwpO/994QhYZi0SNX2um9D+ZYwX3vy44DMzZ90V085VCnpvCcytsQUJbvFY08T2liUNCiVb8c6vw5lLX4Je5gZtDKYvqG4G9GuwszthjCGVChSqS8iQs0y+nEisraitI7Ke+rznmoeqdeZel2wVUORlxRFdZm8Ii9rlsORyLmBvpsZz0fa5UBTDS+UPa4Zce46mm7idPdIFJZaa0njErJ1oLj3yF1OfJu+fvT0EwRJnBIrSTf6IDTYIqX0FnPyFKdhw4zu+rVJJIlW9NNIJJVhZ27Y9Qaz78m6ilSql6f+SEji1wW/tOhBKF8TKiHR7YDZe4qHEXPoUG5HNjZkvkGY7F36X6EgyTT9PBEpqVC7lrwbKOeOch6wg0N31SYVWfb5b5hIYiHohoHfNU783Lp7nlAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"debugCategory\"\n        title=\"debugCategory\"\n        src=\"/blog/static/6f91bb1c3d81745f56fc1e823c17e799/a120c/debugCategory.png\"\n        srcset=\"/blog/static/6f91bb1c3d81745f56fc1e823c17e799/63868/debugCategory.png 250w,\n/blog/static/6f91bb1c3d81745f56fc1e823c17e799/a120c/debugCategory.png 443w\"\n        sizes=\"(max-width: 443px) 100vw, 443px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<pre><code>// 启动文件 通过compiler.run开启编译\nconst webpack = require('../lib/index.js')\nconst config = require('./webpack.config')\nconst compiler = webpack(config)\ncompiler.run((err, stats) => {\n  console.log(stats)\n})\n\n// webpack.config.js 配置文件\n// 添加入口文件 配置了解析的loader\nconst path = require('path')\nmodule.exports = {\n  context: __dirname,\n  mode: 'development',\n  // 入口文件\n  entry: './src/index.js',\n  devtool: 'source-map',\n  output: {\n    path: path.join(__dirname, './dist'),\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js$/,\n        use: ['babel-loader'],\n        exclude: /node_modules/,\n      }\n    ]\n  }\n}\n\n// 入口文件\nimport is from 'object.is'\nconsole.log(is(1,1))  \n</code></pre>\n<p>在上面的代码中指定了配置文件和编译的目标文件,通过node --inspect-brk start.js结合chrome的inspect就可以对webpack的源码进行调试了.</p>\n<h3>webpack的启动过程</h3>\n<p>启动文件执行webpack(config)是通过配置生成Compiler的过程,下面梳理源码创建Compiler的过程.\n启动文件使用的webpack实际是引用的<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/index.js#L94\">lib/webpack.js</a><br>\n在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/webpack.js#L97\">webpack.js构造函数</a>中会根据入参来创建compiler.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 706px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 117.19999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNElEQVQ4y4WU63abOBSF/RhNDEISEheBEMbYxsRx0mk782Pe/3m+WYg003TszI+9jhBoa2/OZaOKivr8jB1mjN/RHY8U/Yj2e1TdkRhHapoV9i3GPffL+u2dbdjILKPsAuWuZz+3nF4D7dhQ9Y56sAiRkCZb0uRn3JKmCeIOIqHKLcaV9PsSP1S4wSHzHCEyUiEQMkNIidQ5UmuEEOv+W0x/ed5kmSTPFcPUcXh94fT9ifDHGf3tQn49R+jrhNkHqn5PHXZIKUnTNBL8jo2UGWq5ue6oj88UYY/Qhkyp9SO5qlwsJ4+PJNvtO9kt0o3MJCrPsbs94fVv6vMT5vKCHnqypiLrGlRokb5BVpYsW4jETXXvCrXOKdue6jQT5gvjPFGFnqLrKZ0j0wqxQMoPh28rlBKtNMYqzLijOh5o5kB9mbDTGdNUMXvRasx0QrLEGyqXCyLhAuMc7flE4R3h1DKeW7wv6XpH40rKMGBdi3EtVbdDScn28eH9ggXvCpfSceOZ3fU77WEmnC6cLzPz11fmb9/opgv+6Svd/MLw+hf9fKVsu0iuixJjTMS7Qq01IewZjlfK/oCuHTbssN7jmgrbeHRRIXMbVeZljW07ijas698JldJIlZD7GtXUmLFGdQWpTEl+/3/btXRiCb2V0Q3LguYwMf74k/YwMr0+cf1xZX4+4UOLGydqHz50yC38q1BKrO9pT8/Uw4nS9/Gf1sMh2i27XbRqraUoirtd8tZ6WfTf1R3lMnmGkcIHisZThSGiOc7Uw5HKNW9t97GHf0UcDlVVojOFSFJUbtDWxu7RZo15Ucb1krx1qqR3sZG2pg4TfpjYTROuPyCsJ8mbFaZZZ2Kcdy2i8J9ikylNWTb0oacbPbbKUUWO8QWmLVCVReQ5SaZIpf5fRMtSKUwbKLwnn67Y/QHTNdjQUjeW3eBom3pNxrvlOwM2k5KyrGiLFls0yH5C1R4hJKnIyIRAqbU90zuD9UNSrDVYk/Pl4QvbpWgfvvD48LAWappGVT8hRLpm+LOyWVoqsxXW5hijyU1OVS0ZVf85uE6Y+2SRUBQO2ezwncO5grK0jKOPMUk+P3yL8B8xf4859cdqlgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"callCreateCompiler\"\n        title=\"callCreateCompiler\"\n        src=\"/blog/static/61143bfacd863a4828a15932971a27f6/9f21b/callCreateCompiler.png\"\n        srcset=\"/blog/static/61143bfacd863a4828a15932971a27f6/63868/callCreateCompiler.png 250w,\n/blog/static/61143bfacd863a4828a15932971a27f6/0b533/callCreateCompiler.png 500w,\n/blog/static/61143bfacd863a4828a15932971a27f6/9f21b/callCreateCompiler.png 706w\"\n        sizes=\"(max-width: 706px) 100vw, 706px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/webpack.js#L58\">createCompiler</a>中主要做了:</p>\n<ol>\n<li>入参处理</li>\n<li>创建Compiler</li>\n<li>订阅Plugin</li>\n<li>根据入参加载不同的能力和应用webpack内置的插件体系(WebpackOptionsApply)</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/800fff7bc13591c48e262e16c05a1387/17602/createCompiler.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAADYElEQVQ4y4WV3XKjOBSE8xpjI5AACYRB5seAwdgm49kke7H7/m/zbYGTGWdmdveiC1WpqtXndJ/DUxj7+HGCrjN2kyPaZUil0DpCG02cpJg0IUkNiVYYrYgiRaQNUWIJtUEphRACIXyevO0W19R004l+njnMzxzHlrfXkb//unD72vH2cuTb64X2dmP4eqWudtiyZteO2KpFJwlCePi+z5MMPUxqqMYd1eQoupysSIjiGJ1qtNVEiUYlGZ7JkcaiYkMQBHjbDYsgz7uTLSqffLFFZiWyPBIeTpjTDbNvCJMcWXXIviN0BaE7IPMakzuypse6PTIIVqIPsrtCXxC6FnW6EZ0n7DBgpxO6awinC/Z0QUcx280XhOfdFW3uypYy7xAPCn2fWCfs+4Hy+kw23VF9+5P9ZcbULeFhInQNtjqQtQO27laVxXDBjTMqitfHVoWB8tDGcDxXHK8lYdkR5A06sQSLc4sSz7vjXckdAX7wjseSVRRgIo2tCqKxJHeWurRkVXXvq2tIm56sO2HzYo2U74v3mPzA95JVGBKFEWXqsGWHrkd0f0FPr2tv0+5MPsy045nuPJOXNXEc4X1S+2iKlARSEkqFqY6o/itF02CHGT3csGWDtRmun3BNizHme4gfCT+wEiqpCKOQfTWxKzt2mSFJNEG2J0hzZGzw4gQ/jNfHH0v8hXAJ6EIahSGxawmLA3VTsC9z1L5FFg0mTfG97S8R+a3C5SKOY+LF+ndHva3HduMhNts7PHF39ad+/ZYwkGIdMz8KEErgBQI/8gniYIU0S48FYvNlHbX/VbjkcLdLGK6OcS45HHO6qeBwyjnOe7prQVo7RFYR2WIdt//sobfZkh063PxGebow3P6gu8w0pzPH2wuHaYnMwOFyxboSpSTiZ2WL6z9M2a5uRtMzcdPixgl3GtmfT5Tzld04rmtqV+RULiHR9zETS/nLtlnOH6RLsKXykNqiu4L0uSI+5ughx1xK0ktJXme4IqGqdoRFg3TduspU2SNdi0mzzwoXZ+OiJR1eiLszxfMb2fFMejhi+4m86ej7PXVdorTBjzTBMn6RXnO5juIj4ZLB3Oa4xBGmBWE9EOclMpA/FsBqgP9pSXw6P5a8/A+WRm+Wnizh/fiKXxeA+JfsPSr8BwDDYDbN/PxcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"createCompiler\"\n        title=\"createCompiler\"\n        src=\"/blog/static/800fff7bc13591c48e262e16c05a1387/17602/createCompiler.png\"\n        srcset=\"/blog/static/800fff7bc13591c48e262e16c05a1387/63868/createCompiler.png 250w,\n/blog/static/800fff7bc13591c48e262e16c05a1387/0b533/createCompiler.png 500w,\n/blog/static/800fff7bc13591c48e262e16c05a1387/17602/createCompiler.png 597w\"\n        sizes=\"(max-width: 597px) 100vw, 597px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>创建Compiler&#x26;&#x26;订阅plugin</h4>\n<p>在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compiler.js#L117\">Compiler的构造函数</a>中主要对编译周期的钩子hook进行了初始化和参数的初始化.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 514px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC9klEQVQ4y42UWZbbNhBFtY2kSQLEQAAEOEikBoqtnhzbvYLsfyc3EdWSHTvt9sc9BeCQDw9VQK2Eceh+okwJPY+UuzVVisi8IMsysru7hTzLyfP8Eq/k32JRFEtcFYVAB4UKAaEdwliE0YjqHA3a+QWpSkQpkFreWOZGImRxE12JQlCqAt2NlGmLDBGRPHLdUMaasNkTt0d0sCgnsY3GxDMK7ctlLrVYnL4JFqg6UdYNhfZIm7A2YKqItp4YA9mff5Bn2fJTdnfheuxlfD3yTbDy6JQI+4566mjnljh1uC7gnCPPizeB7JK3H1k2yyjOORRCoqxBViVxrmkfI2Hvl7HfeWxf0Twkwi5QH2rCPuBHjxs8Ve+wXUV9rKnWjryQrErrUf2MPrxSHb7Qv/6NG59Q8xPy+TP2cOLw/MT8+S+a6ZEiDj+TLjH3G1aFEFTO0bQJ7RWlKyidRJ0r7yXSFMtY6JIsO+dJvI8Q5yMXKGOQoSbsOoavjzTHLfUmsH6Z6B9n2mOPstdK5kuu3mMlhFgEy5Cox47Ny0x7v8Onirgd2Hx6oB5asrvs7fJeqvkei6A2ChMEdthghi1qHTDzBj316M6gvViEzoIfsZJnQWsx3UC1PtCevtKcXgjDgB4m7HBEa7V8fN78Q8GLQ4NpInZ9oJ6/UI0j9jihpwndREotf8vdTVBpg25abL8lHl9QrkJutpj9jDIleX53yd3/XeofuBVFNwm3OxFPr6TnT8SXJ8xuQI97bF3fntdvOyx0QFce17SEbsTVDWUhESairH9z8GuX3wRViapyyrpD1gO5M8hth+wTso+IJlAacbmDNwoK8R3XfrgUxWqUN1R9oH0eSfct8WGN3ybC1OI2gaqrsK0jnRJVX+E3lnrvCGNFmj1VZ5aLv7yUUmnKOGBCJO0ONNOJbn4i7Y40h3tc8KhmRPUHzPqAqRvyPENIsbg7N9hzvDn0wV/ajxDLYvbWjq6t6Tb/rk39Moch1v9Z/Ij8vfV/Hf4D1B5Wg3DBIdAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"conStructorCompiler\"\n        title=\"conStructorCompiler\"\n        src=\"/blog/static/16a0e6501593abc91dcd723939d1ab37/dea13/conStructorCompiler.png\"\n        srcset=\"/blog/static/16a0e6501593abc91dcd723939d1ab37/63868/conStructorCompiler.png 250w,\n/blog/static/16a0e6501593abc91dcd723939d1ab37/0b533/conStructorCompiler.png 500w,\n/blog/static/16a0e6501593abc91dcd723939d1ab37/dea13/conStructorCompiler.png 514w\"\n        sizes=\"(max-width: 514px) 100vw, 514px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h4>加载webpack内置的插件体系</h4>\n<p>通过WebpackOptionsApply加载webpack内置的插件体系,用于内部打包过程的逻辑调用.<br>\n在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/WebpackOptionsApply.js#L278\">WebpackOptionsApply</a>我们先只关注一个插件的处理逻辑-EntryOptionPlugin.<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/EntryOptionPlugin.js#L13\">EntryOptionPlugin</a>对不同类型的entry加载了不同的处理逻辑,在处理非函数entry的时候加载了EntryPlugin.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 623px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 113.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAELElEQVQ4y52VWY/cVBCF+0dAJm3f3bvdXtp2r9PTMz1rJkAICCFEgkDiifz/9w/Z7oRE8MTD0a17LR9Xnap7PDNBiMqXvF4p3h0V99uAx60bkUYWIQRSyglC/nf82X5mrMXlKXkes8gC0kVMmockeUiYJLg4xTiLtgrjNNpqtNH/xONeYYIpniklMaHFrh/Q9RW6b7G3B/QiJ2068m5DkMS4xBAVjiCxuMgQ5ec4sdjQEC4Cwswx01qTFhFREuLiDBvGuCjEk4qXFxf48wt8z2fuCb6aK772FBe+4sVcMvclwhcIz0N4Pi/nciLs+pr97Ynl1T314ZZ+u+ehT+iWFa5oiLOUdRHyrnnB95XHq8Lju0qwT3xsEJLWLSbOuK4NM6M1Qjt+ONX8+arg+X7Jm8eW359S7k8b7u4P/PFQ8NNDy/tjzI+3G55Pe55WOcfdinx9xf2h5ZdTwalLBg0VzjnWi5xdnpEOyFKM9hn0dUaSWB9rFBfKMFeWl9rxQhh8bVHa4JQgtQJPqCnDtu9wYczck5jhA1qhlEErjZQaIQ2e0Cil0VIRakk8dF0PZwqpNGJ4phUzZzVR2eIWJevjkm/vSz48Gm5vKtpdw/L2hvpqx+U6Z3W5JVuveNiXPG9zgihGnUk/YmacwmpDschItz3NuuSvk+JuE5HXGW2b0rcxbzeKOjfI2KKdxvcFSvhI4X8x/DOtzVRm0WH6I+Fhz+Fxy6+vS1bHlmS3oWmW7K72XF927KqMfbPg2C14fxnztCrYNBVFmqCNmcbGWkO+6MiXHaIpqeuQu14RNDmuLEnrjqhsWFcxpy6lbgqapqDueoplT5JmKCmnkkdCoyfCque+V7RdwsWiRLmAtkmpq5QyjXjfeTzVljpLKZIYIRViKPtMNmlozBhkcUFar1lsDsSbK5rDDft9T3R7R7Xfs1k1/HwouG5zbBCj1UAmR/0GPQcM8Ug4tN+4ALfoscs9enVNU1d8uHP89lTweF1xt3bsWsfN0vB2Y6mbnKrKqOucritplgVFkU4lfySNmxX16Zms2yBsSGQlTSLIYk2e2hGLxLLMLHEcEkXBiCFOkpAwdMNNORMqia03uO4SOX+JVnLUaC4U/idIPH8yhY8l/qvkwcuGLIfr59IUaew4W6OTCImWPmp40femBiiJ0lMD9Hn9fLhndjBKpQnDkCwKMWGKiXK2ZUQeBYiowCQ5SdkQ58U4EcKbI4XA8/yzfc3P3RaThoMDO2sJ4pJ23fLNMeV4rKlXDfn2mmR14LDreXNVEy1qdLUmKkpW/YKyrsj73WhhYRRNhIOOcRShXTAOeRwoPGuRgwxhOE7AkFnkDMoGqDAez+I4wAXB+JsYfHHoxWhfQ7kD5PlODuIrKcb9eE+HVU6ayvHcH88+Ncb3P707ZjiQTTakvnCO/4O/AQ0qm/A91bEeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"EntryOptionPlugin\"\n        title=\"EntryOptionPlugin\"\n        src=\"/blog/static/04665545a50713018764d15fce4fb16a/6114d/EntryOptionPlugin.png\"\n        srcset=\"/blog/static/04665545a50713018764d15fce4fb16a/63868/EntryOptionPlugin.png 250w,\n/blog/static/04665545a50713018764d15fce4fb16a/0b533/EntryOptionPlugin.png 500w,\n/blog/static/04665545a50713018764d15fce4fb16a/6114d/EntryOptionPlugin.png 623w\"\n        sizes=\"(max-width: 623px) 100vw, 623px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/EntryPlugin.js#L13\">EntryPlugin</a>中订阅了make的hook,在触发make钩子的时候触发compilation的编译逻辑.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 737px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPklEQVQ4y5WT2XLTMBiF8xhga5flJV7i1NnqNCFpCwM3XDC8/6t8jNSyTQsMF2d+jWx90jm/tHDW4StH6Etc5fFdgWs82jmsL9BGo41CW43SP6uUEqXUCy10/Mk53HrG9iNuv8aMHaEbqFcTLnhcaXCVxfinGqF/AWrqtiR0PaZZ4dsWUzhEliFEjhASKdWz5A/Fxa9BF845uqHl/HDldL2yO1/ppx3VOFH1I33fYLRK8H/BnoGWXGpuh4pPh4FxtaYuK3y1pF5vqIaR0A4UVZ0yNdb+EZaA3nusMbi65fzxPbuHK8PlnsOHT+wv79merkzzmWk74YsCpTVK/QVorSUqZnl7GNk/XmnOF9rjHWHZIUWO+iW7X0/3aoZG6wT0ziOEJn8rkFmOyAQil6kpsUrxpDSXvgmk+n2jqEXMJdoum4CvDLqw2GApakNYujTna4srLa6IY0fZB0IT0omiM51i0M8ZhpCy6U8XVndH5suRm9OJ9eXE/HjgcNrx9Vxz3g90q45mc8P47o5+v6dpKjZTT7NssD4Q3T5ZNgZpPFJ7NrVmVWqy0CFtwBQ1IQSctTgfqFSGzDJyoVKDXliO99AYQ1htaI8P1Ls7Pl9bvjw0VIcD427L/jyzPc1Mx5n725H2ZoOfZnxZvWhMAsYM2qFnP++YDjvGzcR2aXChRPoS5UKS9BXSOLTzaY2U4ke3v4PT0yvLkrquyaOVLCPLct6kzgqUEKk+jeMVEgn0pxeziHaLUDx3Sv2XXruH3wCPH6pUFa9JtwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"EntryPlugin\"\n        title=\"EntryPlugin\"\n        src=\"/blog/static/42bb465a6651f892662fc51d336de4da/d125e/EntryPlugin.png\"\n        srcset=\"/blog/static/42bb465a6651f892662fc51d336de4da/63868/EntryPlugin.png 250w,\n/blog/static/42bb465a6651f892662fc51d336de4da/0b533/EntryPlugin.png 500w,\n/blog/static/42bb465a6651f892662fc51d336de4da/d125e/EntryPlugin.png 737w\"\n        sizes=\"(max-width: 737px) 100vw, 737px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>打包过程</h3>\n<p>通过webpack(config)获取到创建的Compiler,通过调用Compiler的<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compiler.js#L394\">run</a>方法打包过程.\n在run方法中主要:</p>\n<ol>\n<li>定义了三个阶段的函数 run(开始打包) onCompiled(文件输出) finalCallback(编译后处理) 串联起调用逻辑 run => onCompiled => finalCallback</li>\n<li>调用run函数发起打包</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 580px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/e68874f5a553ddb3bda084ca7c980972/b6272/compilerRun.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAADOUlEQVQ4y42V13LbOBRA9RcriwUgGkGAVYVqVlwUO7v7//9zdkgpideTzOThDHhJ4hDl4nJRFAVKFew2PdtxzXjesj3sqNoeIQtEnpElKVl6J0lu8XfSlHS6n2Xkec6iUAohBE4Z+nZH7A8M+5Hj9crudEKVAVFaROkQ3iFjhazKG8EjnMV7Pzsm6UIXxRxoY6i0xwmFNQVNtIQYyG1E+BJR+RnZRESobvHUlg5fVUgpb0KjNCJLUc6j60j/9IwNFUny14xUCbJIkDJBiBVSrubrQqUonSFlSrJ6IEsT8jRlYWOD0A5Rr9GbA/H1K8M//9K8vVN/fad+OtK+nImXA83zheb5jD+NxPMWf16jh45MTzMJZCawcNaSG0+5PiHrEdXtqS9X3P6Z+PiKDgO23WOaLeXmEdOOyGpAuoZUVXdZJLNxbhdWSvIsxYQeFTcU9ZqiPyDrHYX1iKGjbkrWXU2epKyWS7JkRZalc7/PLIwt5zWUpacceurDSDwcCNuWcjfgh4AuxU8qgVTZvGbZL4W+QpiA7I+Y0xP9lyP7l0cO719oLwfa11fC44X27dtM9/4Nv78g40hRDaS2JXN3ypbFlC65VFTtQOECyjlCF/F1hS4d2keUrTCxQ4cG07ToEFEhUDiHMAZhLLkyZFKzMFVEFBoZGnS/ph472suactvhj2tsFymiR7ce1XjcNmI3Eb9vsEPE9BOBovJkhWVhtCY3FW59RrZHXNPj6jUqDIhqTeE7MluTu2Yms80cp6Ymm7D/Z2EKRZ5nBGMpq5q8rPH9htC2aJWTJiselktWDw/3dkma3BP586ZMif39LAshMfWWbv+F9cvfXB5PXC9HXq7PXN7eOF4unE8jTddiygo5n918LgjZBxbqu1AKtCwwxqFciVOWUnm6tuHl5ZGnpxPX64XtuMP6QHE/u5PwIz+E0xelcejYUw07bDVVmYisepJVwnL5MLNarUjnHLzJPksXxb3aTEGoPZvdgCv97QUhbzXx/vwzvx3hdFE6x74fsdr+KJgf+Z3gt0KtFONmYOj6X3b8E9mPKU/S0pfI4rY50+5l+Z8Jfik01qCNJkl+/hvy7M9H9VH4HwgQWhFREHjXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"compilerRun\"\n        title=\"compilerRun\"\n        src=\"/blog/static/e68874f5a553ddb3bda084ca7c980972/b6272/compilerRun.png\"\n        srcset=\"/blog/static/e68874f5a553ddb3bda084ca7c980972/63868/compilerRun.png 250w,\n/blog/static/e68874f5a553ddb3bda084ca7c980972/0b533/compilerRun.png 500w,\n/blog/static/e68874f5a553ddb3bda084ca7c980972/b6272/compilerRun.png 580w\"\n        sizes=\"(max-width: 580px) 100vw, 580px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>compilation创建</h4>\n<p>在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compiler.js#L1012\">newCompilation</a>中创建了compilation并注册了compilation hook.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACxUlEQVQ4y2WUy5KjRhBF+zcEFPWmiockhISARmppNBNjh7cOe2M7vPD/f8NxgHqm/Vjcyk3Viay8mfmSZDlTJfnj7vnt7vnzk+evh+WHsaIIAaslRku0UgghEFn2P2VLFII8z3lZDmcUx9PAdOp43Ae+PEbebiPXx5XpOjLMA92pQ2qLdA4ZPNI7tPcoF7DOrbAFugKNsQQTiSaQmUiiA6Zs8Lsjxf6Ia1p8WaN9iaobdNsg6xLTVOjQEGKJlP8AKq0QeUaaJuRpSp4miCQh22xWiWRDmmzIkg0iTRHJU9miNCVdYiY+gNopbFOjfI0KAVWXqPgemwpZRny1pWhalNMopzCFRnuF9hoTNDZqlFULUKJUjt6f0d0N2bTo+YyZe/R4RPcHXFcRux3VucXvHKHzq/zWrsk8wQplJC8iy7HeUDYR7wu8d/hQoEOJLSLGOkSWkovFyXQt/rd6LcqSjCxd3H//sjQpZQxMc8t0a+mnmuPQ0r7NdLeB7alEBY0MBlUaVHzK1gZbGlz9zFKI/Nk2NqYoZVCFJfSR4lhhtwVu64mdpxpr2oNlmgpeLyXjGOg7Rxkdymq0VaupMpdIKd9N0Rp3nDHdhJ0e+PFOHG/4qkHvR366Hfj9Efl5kvwyG3591Qz7kizLEelHUz8bWyxAhR0/Y+cfceNnquGN7vaV5vSK3/WUw53mfMHvzwhdsMkk6WKmNihjvzf1ClRaoLXBNC3lMNDMF2LXsX29sr9cqKeJsus4DzvqYcL1E7o5oGND2LU0/YS1dh3BFahthlIaU1U085H2baAZOnbzyHY+0147jmNNHHpc31OMZ0ysKA8nqvaIUvLjy4vLizvLLO7qjl084E9XXH8jjJ/w227N3hqDsoHcRXJboKzDhoj1AfW+NL7P8nKEMq6PpMgRy4VFUj4vLdvkv1tGLBsm/deW+VbDvwG+jLNEjVhjvQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"newCompilation\"\n        title=\"newCompilation\"\n        src=\"/blog/static/031d2d99ede16679c6a87ef5bb26a337/32056/newCompilation.png\"\n        srcset=\"/blog/static/031d2d99ede16679c6a87ef5bb26a337/63868/newCompilation.png 250w,\n/blog/static/031d2d99ede16679c6a87ef5bb26a337/0b533/newCompilation.png 500w,\n/blog/static/031d2d99ede16679c6a87ef5bb26a337/32056/newCompilation.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h4>调起打包逻辑</h4>\n<p>在<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compiler.js#L1052\">compile</a>中触发make钩子调起EntryPlugin的打包逻辑.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.19999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVQ4y6WU6W7bOBhF/Rgzo4USKVKURO2LZSm2m6ZNi3n/9zkDyU4AT1L0R39cSASIg8v7LQelFEkiGeYB1zbU00DZlEht0VqSWY0xiiwzFLnG6IQwCG4Kww86GGMIwhBZDLjlhfL6k/Z4pX164fzjlZfvZ759O3G+HGkuz7jhiLI5MjFEkSC4g7fvpoM1BhGGKGXI25H6ONM2E80wMx1bxnlAjxekTvnrbw/f9wkD7wH04DCxGUIIhFLorqI4j6SnkXTqMc4i0xxbOpzLsEbuYE8XCJl8Cj3oLN+BUaLRfY099eRfZuzSkY+ObKjoJsdw7RjXmn+fHT+/1iy9wfODTzJMNEKERDLBlg3VcaYejjRtx/FYsq4N6XAiqkdEVuJyTWkEqbrn9z+Xh0zrPcMoijFZsxejm6+Mw5X56w++fL/w8nrhfF3QzUhYTYRFh8ocsbFIlTw+OY0l0ZahEKjE4PqZvK4Zqoq2KanbElc5lEn3O0HwsVUegPl2cXcYESuFna5Ul1fK9cLTPLKuC/2y4OoKs+cdftp/70Cr1K0oUXwDy4S0X1DNkaJoGLuKZmip2gptc3w/wPM8Au+fm3yPwPdv2vtQJXdgtEtEManrqdZnumll6heG9YnlujKtJ/qxxWQWkdcIu+WYEW9NvnO2DN+L8gYUSGVw3UTeTVR5T9NNzE8TyzowTD2pNQSmQKQ5kU6JlSaSaucc1PuT70AhiEWEjTVaSVyhb4BIEeqcIC2J0oJ4G7vPnqy13sN8g0kpKV1JqlKSRGG35WBTRKyITHZzZTKiWH4Yu9voJY8ZFkVBHMd4/m1uPc/H34oQ+Hc3d/1qlrdt8+awLEu2874AwvC3+tThluH2k2XZAyz4xb77nXbglpu19n2n/QnwP+14BMalEIq4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"compileFunc\"\n        title=\"compileFunc\"\n        src=\"/blog/static/719fb9b2f1d3af5c5b7b458fff431ae8/1e043/compileFunc.png\"\n        srcset=\"/blog/static/719fb9b2f1d3af5c5b7b458fff431ae8/63868/compileFunc.png 250w,\n/blog/static/719fb9b2f1d3af5c5b7b458fff431ae8/0b533/compileFunc.png 500w,\n/blog/static/719fb9b2f1d3af5c5b7b458fff431ae8/1e043/compileFunc.png 690w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n上面从函数调用上打包过程的逻辑已经梳理完毕,那到底是如何触发对应文件的解析和输出的呢?</p>\n<h3>深入打包过程</h3>\n<p>在触发make hook的时候触发了compilation的addEntry方法开启入口代码的解析.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLElEQVQ4y42T63KjRhCF/Ror5sIMc2G4CiEkZMmKXYnK2X3/9/m2QFZV4nUq++PQ1ECf6tN8PEmp2A41u9OJ+ngljTOhrLGhxPoS5z3eO4SQSPn/etJaYZ1nP888nyYu55lxnkjjjtB1NNuaVHuUkeRWo41G5xql1Jd6MoXC5oZYRZp5JA4dvg7EXU1z2lPPI2kcqKct1VAT2pIi2rVZa73qX4ZKaYzJ8VXL+Xbjenvj8nbh9f3GcP2T7vxGM/9BPx1p2wap8rVxifeonyJrrLUorTnPHT++n3n/+8ztr5mq367n9+a7Ho3/NP00oVoNvfdo4xDKIrVFaEtu7D3SF43/ucPlEmOgsIZs8w2RbRAfdbPZkGUZQgiyDy1Tre8s549nmVjrPbJSGFsQ2i2uagjN8lE6Qt3QdYmqitTB0wRHHRyuKAhNj286XFkRo6PvE4X3q886obGWOD4T+z3l9Ew5nSmPL3SHI2mcCNsDbUpU3Q4X4mpUxMUk4JylqgK2KNC54WlhatmTzC0qlGjnkc4gUkCUnhgtw5AYxoq+D/imQbqA8om86jDGstlkyEfkhUOtNHHY0r9daC8z+8uO6XWgfdmTng+0847+eqS9zpTHPXHbYWON8eFXDlc4lSbVDYfTxHicGA4H6hQw1iFdiTQOaQOyiCjryG2BXghQvyK07nBBpkoJJcWq5b+9S6BEhpRijbTeC/ERT3zJ4zqhc+6+xwXa3+Ttoc9w/wSLso7KFzNfoQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"callAddEntry\"\n        title=\"callAddEntry\"\n        src=\"/blog/static/9ef339ea14e4f0e5201b9609222cc31f/7422e/callAddEntry.png\"\n        srcset=\"/blog/static/9ef339ea14e4f0e5201b9609222cc31f/63868/callAddEntry.png 250w,\n/blog/static/9ef339ea14e4f0e5201b9609222cc31f/0b533/callAddEntry.png 500w,\n/blog/static/9ef339ea14e4f0e5201b9609222cc31f/7422e/callAddEntry.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在调用了compilation的addEntry方法后触发了如下的函数调用链路:\n<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1762\">addEntry</a> =>  <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1797\">_addEntryItem</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1713\">addModuleTree</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1445\">handleModuleCreation</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1460\">factorizeModule</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1140\">addModule</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1213\">buildModule</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1557\">moulde.needBuild</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1250\">module.build</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1581\">processModuleDependencies</a><br>\n在这一串调用逻辑中完成了:</p>\n<ol>\n<li>入口文件的依赖解析和打包</li>\n<li>入口文件依赖模块的解析打包过程</li>\n</ol>\n<h4>创建模块</h4>\n<p>在处理入口文件过程中,在调用factorizeModule的时候通过SyncQueue发起_factorizeModule的调用,在_factorizeModule主要是根据当前模块的工厂函数创建模块对象,在EntryPlugin设置的moduleFactory函数是<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModuleFactory.js#L192\">NormalModuleFactory</a>.NormalModuleFactory继承<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModule.js#L173\">NormalModule</a>,在NormalModule中封装了模块的build方法等供后续的调用.<br>\n在创建完模块之后,通过调用addModule将创建的模块加入到ModuleGraph中进行存储.</p>\n<h4>模块解析</h4>\n<p>在添加到ModuleGraph后,调用buildModule通过SyncQueue发起<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1224\">_buildModule</a>的调用.在_buildModule中发起了module.build的调用开始文件的打包处理.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 634px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y5WU3W7bRhSE9Ra2JJL7z12uuOKPJdlSZEZG2qRugV70qkB71fd/h69YKjWMxm2Si+GC3NnhOTMHuyiEYhs0f0yKvz7V/DbVNIcTYRzZ9oHTNDIcEq5xCCWoqoqyLOf1LSyErVFKknYj3UPP4ZQY7zvaIWK8ohkcYXDYqJFWfCH27/eFEBVCSDbDHtsk2jbSpgbvPet1SVFkopwhpKISgmK1olivX8Reiy7yQwiBqEqaYU//9Ew3/Uj3+IFmd8R1ezb3Z4bLR+5++Jnu/IRvO2yzmcW/qDB/zIJ17WeSjS116rCb9npIW0pp0Xk/trhNwsWECfFtQSmuRvvQkFJP0420/Z5t7Kl9IKVA8BbtasrVktXy9v9b1mWFkAIpJcZvSceJdDjz6/sjv/904s9fjny4PLA7P7J9eMRvErmI8lUorzG3nAlKKex4nL3bv39ien5m2B+Yznvu3p1J+wdCFlN6tui/x0Zcq8uCOZR4P7E73rM7v5t/dHNzw/L2ltVyySq3WpSURfEK6xdUc4VVNQtqJZHWY7aHazhNS93EOQwfanxtCdZgdbamwYYGk4MK8TM/orTOguU8hypXWUfMcKI7XRgun+injwyXZ/rdSPSO5CxeKVzbU6ceF7f4NOK3d/OqtWEhPnuSW9bWYTaJZuywwaKDxUaHMJJSllRGIKxA6hIhiyt0gXLlDGkEC2EcoqquoViLsgoTNbqWaK8wQaGcRDuFbTQm6HnfNJmTuQaX7IzMXVzTERhriJtIVVYU62z8tyPz/znzEkoI4as3ybdgFpxbVerNyf9ewb8BtKTIWzZXMsYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"callBuildInternal\"\n        title=\"callBuildInternal\"\n        src=\"/blog/static/a0084889d86f5adb501cad2a829b8292/374ac/callBuildInternal.png\"\n        srcset=\"/blog/static/a0084889d86f5adb501cad2a829b8292/63868/callBuildInternal.png 250w,\n/blog/static/a0084889d86f5adb501cad2a829b8292/0b533/callBuildInternal.png 500w,\n/blog/static/a0084889d86f5adb501cad2a829b8292/374ac/callBuildInternal.png 634w\"\n        sizes=\"(max-width: 634px) 100vw, 634px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n在module.build中发生了如下的调用:\n<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModule.js#L853\">build</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModule.js#L661\">doBuild</a> => <a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModule.js#L984\">this.parser.parse</a>,主要完成了:</p>\n<ol>\n<li>在doBuild中调用<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/NormalModule.js#L728\">runLoaders</a>调用设置的loader解析文件</li>\n<li>通过parse方法解析生成的ast 生成依赖模块的信息</li>\n</ol>\n<p>在当前Entry模块解析完毕后触发回调回到上次发起<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L1288\">processModuleDependencies</a>的调用开启依赖模块的打包.</p>\n<h4>打包文件生成</h4>\n<p>上面梳理完了模块的打包过程,通过loader的转化能力和plugin的劫持能力已经将文件转化成需要的内容,它存在Compilation中.通过make 钩子触发编译逻辑之后通过调用compilation的<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L2141\">seal</a>方法生成文件.<br>\n下面是seal中的一些关键方法的调用梳理:\n<a href=\"https://github.com/blob/cde1b73e12eb8a77eb9ba42e7920c9ec5d29c2c9/lib/Compilation.js#L2141\">compilation.seal</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L2168\">EntryPoint</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L2284\">buildChunkGraph</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L2375\">_runCodeGenerationJobs</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L3651\">createChunkAssets</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L3643\">getRenderManifest</a> => <a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/Compilation.js#L3754\">fileManifest.render</a></p>\n<p>上面的一系列调用主要做了:</p>\n<ol>\n<li>根据入口创建EntryPoint 他是一个chunk group.负责维护与入口相关的依赖.</li>\n<li>buildChunkGraph 生成模块的依赖依赖结构 相关的模块会保存到一个chunk group里面</li>\n<li>_runCodeGenerationJobs调用module的生成代码逻辑,生成代码</li>\n<li>最后通过getRenderManifest fileManifest.render进行最后输出文件的拼接.</li>\n</ol>\n<p>比如在入口函数中会通过<a href=\"https://github.com/blob/1bfb44678e8dccba3d96614df3e12778c4675655/lib/javascript/JavascriptModulesPlugin.js#L546\">this.renderMain</a>的方式拼接代码.这样就添加了打包出文件的Bootstrap逻辑.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 646px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQoz42SWW7bQBBEdQ6J5Owrd1mUxUSOEPv+Z3oGR1ZiA0GSj4fGdAM11TWzE02NdBE3X5he3kjjjIo9aujQxxE5doShwyhNXdc0TfNHHrNdIxqs8cThiW694WNivz9Q1TWHqi51o/6o+6oq/UOZV4WH2FZ3QkqUkCSfyd/faK+vDC8/ycuV5Xziuk5cziPP55HrOnNbj9zWhSFFotUEZxBC/Ha4HYQUxJiZ5gv9ONBmT3KG7AxWK7xRWCUJRjMEV8gf8xQsQsivglIKQky08zP9NDL0ic5b+mCLizH6gtN34ac2cGojU9r6jqkNOGfvK2+qSiliP2Jixmp9v9kagtNopf76GI/svjg01rAsPzievhG8Y4qOOfmy7ud8/sUvh8YYXO7QIWGUKlltbM4/f4n/4R1XDeNFpqw4PgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"bootStrap\"\n        title=\"bootStrap\"\n        src=\"/blog/static/71dda616183f18729fcaba2eba2042f8/27524/bootStrap.png\"\n        srcset=\"/blog/static/71dda616183f18729fcaba2eba2042f8/63868/bootStrap.png 250w,\n/blog/static/71dda616183f18729fcaba2eba2042f8/0b533/bootStrap.png 500w,\n/blog/static/71dda616183f18729fcaba2eba2042f8/27524/bootStrap.png 646w\"\n        sizes=\"(max-width: 646px) 100vw, 646px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>以上从源码的角度大致梳理了webpack整个构建的流程.通过源码的阅读可以看到webpack在设计上一些可以借鉴的点:</p>\n<ol>\n<li>webpack通过tapable实现代码的构建流程这样在实现上业务代码的职责更加单一和清晰,但是一定程度上也引入了callback的处理逻辑</li>\n</ol>","fields":{"readingTime":{"text":"8 min read"}},"frontmatter":{"title":"深入浅出webpack-webpack源码解析","date":"2021-04-12","tags":"工程化","path":"/webpack-code","top":null,"summary":null}}},{"node":{"id":"1f7b7751-fc22-5372-b6bb-443b12f33c94","html":"<p>webpack是前端代码的打包工具,熟悉webpack的的工作流程和相关配置有利于在业务开发中更好的组织业务代码和实现一些特定的功能.webpack主要基于loader和plugin来实现代码打包过程:</p>\n<ul>\n<li>loader 主要提供了非js文件的处理能力 通过loader依次对目标文件进行编译</li>\n<li>plugin 主要通过webpack在编译期间的钩子来对编译过程进行干预</li>\n</ul>\n<p>webpack的钩子触发逻辑都是基于Tapable这个库来完成的,在深入浅出webpack这个系列文章中我们先从Tapable的源码开始逐步深入到webpack的源码中来了解webpack.</p>\n<h2>Tapable的简单使用</h2>\n<p>Tapabel提供了多种类型的钩子和订阅钩子的触发方式,这里以SyncHook来梳理一个简单的钩子使用方式.</p>\n<pre><code>const { SyncHook } = require('tapable')\nclass Car {\n  constructor() {\n    this.hooks = {\n      // 定义一个同步钩子 钩子的构造函数接受多个入参\n      accelerate: new SyncHook([\"newSpeed\"])\n    }\n  }\n  // 定义设置速度函数\n  setSpeed(newSpeed) {\n    this.hooks.accelerate.call(newSpeed)\n  }\n}\n// 实例化\nconst myCar = new Car()\n// 监听钩子accelerate的触发 \nmyCar.hooks.accelerate.tap('acceletePlugin', (newSpeed) => { if(newSpeed > 100) {\n  console.log('不能开太快呀')\n} })\n// 调用实例方法 设置速度 设置200的时候 会触发提示\nmyCar.setSpeed(200)\nmyCar.setSpeed(100)\n</code></pre>\n<p>通过上面的例子可以看到钩子的触发的逻辑是:</p>\n<ul>\n<li>创建钩子,定义钩子参数</li>\n<li>订阅相应钩子的触发和拦截功能</li>\n<li>触发钩子</li>\n</ul>\n<p>通过钩子的触发逻辑可以看出Tapable的实现逻辑可能是基于发布订阅的方式实现的,但是它里面对订阅的处理是怎么处理的呢、如何高效的触发呢? 这些都是成为一个优秀的库所必须要考虑的事情,我们就带着这些疑问来看Tapble的实现逻辑</p>\n<h2>源码逻辑</h2>\n<p>以下源码梳理以SyncHook钩子为切入点,分为以下三个模块梳理:</p>\n<ul>\n<li>钩子的构造过程</li>\n<li>订阅过程</li>\n<li>触发阶段</li>\n</ul>\n<h3>钩子的构造过程</h3>\n<p>在通过new实例化<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/SyncHook.js#L35\">SyncHook</a>的时候在SyncHook的构造函数创建了底层Hook的实例并且重写了Hook的方法过滤了SyncHook不支持的功能\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 469px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxElEQVQoz32SSY7bMBREfY1Y1ERNlijTFiXLmmxJnhKgk00WuUZWOf8L7E660Y1OFgUQxK+Hqk8u3CBGbjv8dY1UhrbZchgq5qlmW7eo5kiSpmy1Jsk15fUbySolyEuCckRu9sSmoygLXM9l4fk+wSoiUCGrMmFdJ2z6DDMr1D5l3WvWfUpWRbiehxeEOI6D4/k4foDjSVxfIgP5uF/4novMNkhdI7VBtmdilSFzg78tCcYa1dQU841YrVl3I6Y/EvgeQljYto1tC4QQj/PCc10C0xH2F/L2gBou5N2EPpxJdIGpNNNpz/XzgX7Y4cmAeyvXdZ+TvtPCv1dOQpIyYXdYsW8jmj5GlRGqStkeFc3FkOsUyxI4tv1ivkPf61E5NB1+c+HHmPHru+bn14xOh+Q65zTXXK8tT08jSq2Q0vsw2WvC+w5Ni9ec6dqC26nidtoxDAZjNoxTzTTVzHPN+dxQGI1lWQ/z8/7eauE6NnHRkrY3mn3F/GWi7mviKGIYSo5jRbXbYNsuy6WFEPYL7MOEURyhVzllskFFGW45EBV7HCFYWuIPRLwx/Qv2AKb3LxIGfLKWj+d3xBJbWB8O/w/0F/gbfDImzfUplnYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"同步钩子构造函数\"\n        title=\"同步钩子构造函数\"\n        src=\"/blog/static/fabb95efaaa8baad0c7438753b657a71/5f759/SyncHookCon.png\"\n        srcset=\"/blog/static/fabb95efaaa8baad0c7438753b657a71/63868/SyncHookCon.png 250w,\n/blog/static/fabb95efaaa8baad0c7438753b657a71/5f759/SyncHookCon.png 469w\"\n        sizes=\"(max-width: 469px) 100vw, 469px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n在底层<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L25\">Hook的构造函数</a>中主要做了如下的处理:</p>\n<ol>\n<li>入参存储</li>\n<li>创建不同方式钩子调起(call)逻辑</li>\n<li>创建不同方式钩子的监听(tap)逻辑</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 441px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.00000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE4klEQVRIx32Va2/bRhaG/Su6tkRyOJzh/X4RKVE3y5bt2AnSdNMWbrPtdi/AFtgW7WL/P56CZOzYTdoPQ1Eg9eg9533PzInjCFSUoeoddtVivX2H+eZ7rLf/QNz/G+v1t3h+iMoaVLNB1z1xVRPGEfXVHUW7xPc8TNPEsixOdDTDsmykKwkWAclFRXJRk143xJcNwa4kqD2izifbx8TLgKj1iVcB6SbGVjamMcFGoJucYZk2UgvCxiXZBgQLl6DSlGvNcq8JKxcv14RLH+FKTNtCSIElLUzLxDIn2KDyREUzxKDQ17iFR7UOyDKNqnz6VnHff0YSCYLaJ4wduo1Pe5kSLXzKfYxynecKhZhuVFKj05Yvzhu+2mf4YUTVLFjUJU0V0+9aXl8t+PlKsS89FklEEwdEUfSobgSapoW0bXI/oY0bSi9CJxVeWvHjpcPrlY/2Q+K2pz0/Eo+K5pjvIQ+gR4VybhBE0ahobhqYtj2+LCwL25ghzPn7HxoYhsHcMBhEDN/N8f7hc4Kf+FIivRDVHJB5jdr3uHWF7wcIpbFsOVYgpcSWDo52EWIwxEEoD0sqbEePzyeFjsIZoFGBqrbItEWmS8K6p9ofSboNeVGQJAlh1VLsjrieh5MvccoembX45YogCBC2zYmQJkLY2EIgkxKvrMg3K8rDBa7rElUteb8fWzCW9qS8T5aswik2trRxAhe/DsjPc+IuRjoOUnsMVVi/a/4frZPhMvTEHvqUL1FpQ7m/Jm3XYyQWl7dEefloyhjkJzH5CDg4ZttiKrnoUcmC+vCCvD+Q5hVNt0YqjS0kruthDYb8GdB2jKmHg8I4I6grkvWSaN1THg/k5zv8siCIPepFgRAm89n8EfpRDp/30MMtfYqFZrMOiBpNdShotgXlRUN+XpOsKpwnu8vjGuAPJYuhZFvgFD0yafnuWPOf64IoCvnrv95x//OP3Pz0X27+9yuf//8Xiq5hfno6Tcx8Nq330JPBkMkUgcy60ZQfLhO+2ccUfc/du3t2X37F9d9/4Oa7b9n/7Z/4VYepPOwwRQQJdhB/UPjBZTG67GQt7y4Lfvp8SXN5S7hYE4c+3x9i7voUsXmF3r1E7+5Qhze4118TLvdYQx4/AmZL3Kzhy13Ky5sD2e6aqKgo6obXdwfK7QG5uUX3R9QA3b5AVSuUF2AY84fYmGNkRpezDp0tSDYXlMdX5Os9URzhbF4gr+9R+1cjxL38An14Q7DYYM1OHw0aJ+V5sDvcoiNtl2TdmqDdobMGvbnF21xjJTVm1mHlHU65QvnhM9h0pszNyeUh2HmPSgfghrha4lZb3GyJLLZ4SU2ReGSxRxzqyVnD+JDHx/1Qz6ccDgrDiKDJyHct5dU5+bokyofjoMQtY7bHhtW2oijS8f1PTcuJ4z0BDhttnZL0FWHu4jcxelFTtQHdNsVQJmfGjL98djrO9cPx8RT8YZbHHk6zXO5vKPoD3tCrICetGqplTxS4VFVCloW4rub0dDaCn/XwwZTh34ZJ0XlLc7yle/mW5uoVebdCRxkiX1N0S+7uNty93LLdLWiaDKUUxtNTb7gM27fneQgdYGsfPyvw0gI/K/HSEuVIbDfAVMMp540Kk8SnLJNPA4dyhwfmfD7O53x29riMYRnmNLfDs/mc2WxaZ2cfl/wbpkc9NezuXmIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"底层钩子构造函数\"\n        title=\"底层钩子构造函数\"\n        src=\"/blog/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png\"\n        srcset=\"/blog/static/cddadaa923563693da8a82c7e4708f08/63868/hookCon.png 250w,\n/blog/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png 441w\"\n        sizes=\"(max-width: 441px) 100vw, 441px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>订阅过程</h3>\n<p>在钩子实例化的过程中返回的实例绑定了不同监听钩子触发的监听函数,这里我们调用<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L77\">tap</a>函数的时候,会调用内部_tap函数并且传入绑定的sync参数和入参.在_tap函数中对入参进行了处理和过滤器处理\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQoz4WRSY7bMBBF+xqtkRLF4iSKtGTHQ3eCbHKF3P8mLzDjAEE2WTyABImHX/Xf3ruRH8fEz+8Of/9G2Av545P8+IqEhIkZEUvXtnRNQ9e1L7rf9+a9vvV9zzAMvI3DwLws+GNnvV/wJeIfG3LPaDFsybGuDhHBxA0tFm0dWmtk3ZBUMC4wjkOVVuGkNf44SB8X1mvCPRLDFtFW2DZPzhHrPPb0BW0Ds3gWI8i2Y/OODZFx6P8R7gfpcSFeInJKqMXjRHM+J0qJpOQ4ZVcTn0qgZE9cYxW6cmB9oO+6vxMW4m3Hl4Bkj44BMZqcQ5V5b/BeKs8VBG+wIWCeY8fEYswr4fgULqhYkOi43jeut0S+3vDnB36/Ms8zTdvStl2laf6cX0W1TS2plqKUqgvvR8U0zUxKMQ4jappR8wul6uf/8Uz4CwkaymFOFPmPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"_tap函数\"\n        title=\"_tap函数\"\n        src=\"/blog/static/b003abad27e92cd6307a316a5118d62a/267f6/tap.png\"\n        srcset=\"/blog/static/b003abad27e92cd6307a316a5118d62a/63868/tap.png 250w,\n/blog/static/b003abad27e92cd6307a316a5118d62a/0b533/tap.png 500w,\n/blog/static/b003abad27e92cd6307a316a5118d62a/267f6/tap.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L136\">_insert</a>中会根据当前监听项的信息将它插入到taps的正确位置.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 423px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABj0lEQVQoz3WSyW7bMBiE9RyRuGshRcm2YsubrDhxXNSXPkRPPff9D18huU2CtD0MBvxJDmcGTISU5Eqwrx4YQkbvJcYVaFdQliXGGLI0Q2SCLBWICdkHCIGUcuYJSSoUbS75cTH8/Ob5fqtZDgOPX270xx2+9Ugr0U5hvcGUGu002qp5pox6E52QTAvnHMYZbHAUq5ywzml2BbEvWY6R9hCIm4r1taV7bQl9SdE4/Logj252+i4oJcZoTFFh1yNlu2S3W/B07nl+2XK97jmeHhnPG8ZxQ7fscMaRPqT/jJ8IKbDW4gqD85ru2rK6xPn1ZvAsn2sW55rVayQePUpLtNVz1AlzdHuvQCpJMtl01uEKhws58RBYnCO+K2n2gXYI1NtA2FSzcL2tCJuSuq8IfUU8eBZPNe0pYJy+R3bWYkuP7QZ819O9fGV9OtP1W6pqEh7pL7e5mrkrJVHqzn+6e+swS1Ni2xDbSJoJlNZoY2dWSv0WuM8+fo//IZn6a5pmvvy+kf19OMuY+v7s6LPDXzgWA4uhdV6tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"_tap函数\"\n        title=\"_tap函数\"\n        src=\"/blog/static/44794c72173ba543b2450d5ba600480b/f687d/insert.png\"\n        srcset=\"/blog/static/44794c72173ba543b2450d5ba600480b/63868/insert.png 250w,\n/blog/static/44794c72173ba543b2450d5ba600480b/f687d/insert.png 423w\"\n        sizes=\"(max-width: 423px) 100vw, 423px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>触发过程</h3>\n<p>在触发过程中是通过调用hook实例上的call方法,这里我们先梳理出call的实现过程然后在从源码的进行分析\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 363.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCABJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHu4IVAFRkLGAqUmVNDJvIuAKtNMAP/xAAaEAEBAQADAQAAAAAAAAAAAAABABACESAx/9oACAEBAAEFAtYxjEgiYj4vULjGNxx9f//EABQRAQAAAAAAAAAAAAAAAAAAADD/2gAIAQMBAT8BL//EABQRAQAAAAAAAAAAAAAAAAAAADD/2gAIAQIBAT8BL//EABoQAAEFAQAAAAAAAAAAAAAAACAAATFAQeH/2gAIAQEABj8CW0nkuD//xAAgEAACAQQCAwEAAAAAAAAAAAABEQAQITFBUWEggaGR/9oACAEBAAE/ITkRlP6FDULLvfuic/JtkX4gLjCbQhJ2MWlgm+GtxHruYIpLz9ppmL7K2LvtZppPY8X/2gAMAwEAAgADAAAAEKPMDHPHPOPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAwEBPxAv/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPxAv/8QAIBABAQACAwADAAMAAAAAAAAAAREAIRAxQVGBkWHR8P/aAAgBAQABPxC4CltmUYRJoDgAKWV7SfmGoR3EdDhJmid9sJKjpt7D3AFNmKin42TFZ0KhHeBgk24RdhCfZym0m3QN56PgxKH8rlXoV2Or5xHbbyFxIqAZ/tcCh9ncwJYZ/Y47rXu0uNfTfQh/eDn/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"call梳理\"\n        title=\"call梳理\"\n        src=\"/blog/static/542d374ac0a67cda1e65467eec38cd64/aa65c/call.jpg\"\n        srcset=\"/blog/static/542d374ac0a67cda1e65467eec38cd64/0479a/call.jpg 250w,\n/blog/static/542d374ac0a67cda1e65467eec38cd64/aa65c/call.jpg 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/SyncHook.js#L40\">SyncHook</a>实现的父类的抽象方法compile,compile方法也是基于基础类HookCodeFactory组装实现的<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 111.20000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD4ElEQVQ4y32U2Y7bRhBF9RW2h71xF/d9FSmNZvPEAZz8RZ7y/68nIEcTO3bgh4smC+RBVd/CPZTGotWKNjC0vqHbTk/TeJr+aDOmzl6vjdrfh8Shj20qJSnlN9VCkEnJYYju8H2bqA/IzzHZFJIOIVHtUV0TsvlI0gckQ0D1GFE9pCRViJISJSRaSqSU2FpTbcDKlgRZQ1DVHE8l4bknvPQEa0+wtDhNgVtkBO1AOJwI+u27CW9o8YYGp8oJqoLAcSmE4JBakjEP+ftLyl+fE7qhJT4/k5+vpF1HebnSPX/hWLRk8xPpfE/x8Ey2vp3JMFG0Db7jkFsWh21+zyjqKOKxbinSFL+aqOqSeel5eFqZ14HLpWUaG45RhOuH2LaN0QatNUopbKXeOtyArrHRts14OTHfL0RRiOd5uMeYME5Qjk/TZDRNSl7mxGWD7/v73WmtUPoHoGcbjO1QnJ+pH38n7WaOZcuxqPHjFCUFQsibBFKIvautu71Drb8BN2dcrUnTjLSoCOKEY1YSFTVR2RCmOVopjNY/a4MqtQOdd+C2O47vYYchd0ryUVi7Plh3uz5aFp+U+kkft1NrrJs26A58UIoXz2eyBJPQTNKwSMWqNItSLEZx0jcZvZ+LVlyMYbUsKiFItuUWYn8+zJakKWfKpOJyWlgvj/R5QRVXlPVA2bd060y7znSXE+3YUdUFfZ4xbstsWbhKEdycPhTblhcDqj5RLyPLWjNNOV41IIoZp5op718p719ImgHbdZFK82EzU0oiKbnTGnkb+1BYFqHr0/XPRNlMNC401weyfqIbW9brQvv0heb6Qtl0uxnvRhyl3McVt9qmQ2s0WRzjGwfPGKQbINwQ2/UIQ5cg9HCDI05wxA+PGGP2lRFKvQGF+Be41Q+1lHTGkAuxp0YrLRolaLY0sSTFpztqsV2+RXF3t2tPGG1opSIxNsqYtw63kZU2OHmP16x45ch0mblcek7nifLxM/E476NGeUX3+idlP+EXPW454pTTXncdB/kO1ErihAled49fjQTr6x4Ex/ZMWJfU547L05VxPRFVHXk77FG1xdf27x5jN9g+8lY0SYmzvNIsC+vTme58Iq47/GYmP63Uz6/UTY4WFsKydkP0D3qHHmwlKYKYopq51Blfl5IvU8GahvRVRzE9U51+Izm94hVvLv8f8F2HUAimIKYcn3gcWr4+zdy3BUue8Me142XpGJOYRjto17u5+QugYzStF3CftJyOGVU702QVqRSkWpEpSSYFgbCQars3/RZZ36XNf4C242B7HpYUWEphybcdE0q/vSu975n8Lqp+1eE/vS2C791tVqkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"compile实现方式\"\n        title=\"compile实现方式\"\n        src=\"/blog/static/f40c6fcf44a8453f6214b5593c81ed49/267f6/compile.png\"\n        srcset=\"/blog/static/f40c6fcf44a8453f6214b5593c81ed49/63868/compile.png 250w,\n/blog/static/f40c6fcf44a8453f6214b5593c81ed49/0b533/compile.png 500w,\n/blog/static/f40c6fcf44a8453f6214b5593c81ed49/267f6/compile.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/HookCodeFactory.js#L14\">HookCodeFactory的create</a>方法中通过调用contentWithInterceptors进而调用子类SyncHookCodeFactory的content方法,在子类SyncHookCodeFactory的content绑定的SyncHook的实现逻辑callTapsSeries.\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/HookCodeFactory.js#L276\">callTapsSeries</a>中主要完成了订阅数组taps的代码串联逻辑最后返回new Function完成call的调用逻辑<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 122.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAADa0lEQVQ4y5WV627jNhCF/RitLVHiRSJFibr6GifeptldYIGiKAr0/R/lK0gnzgZFiuTHgQiSOpzhnDlcKaXwbcfXv/7h659/c3n6zjjNyLIkrkkpP4WVMYY8z/H7e/rLN+owIoqSXIg0/1kkwqIoaKYd7e6ErmqkUmTZBiHEp7HSWqdBOF2Yf/9Bf7pg+xFVO4TIbxvj6R8jlIpI2oQB03RU7UDle1TdkG3yhDzL35D+H/mqrhWllOjGY6eJZmhxjaSQG5Qt0F6hrLyRvoeXQ1bG6nSHhbVUweP3M37bMTwcafc92pdoF4uUkeeb2+VnWUaeZdfvT5GvjPOJ0DWeZhkJ91u6Q093f2C4HGiPI+1xoLsb03osWCkVta3RRqO1SXJ5jbC5EtbKUHUNuvPo1lIvge64xS89buzwu57utOC3Djc4jKnQlblp9ZWwqilETlk5yn6LP90x320ZdiPd3R3NsqCsRZoYmaCQAlGKW8ovV3BLOZ6Q7lAqnBs43J25/PjO/nRgbGfm3Zkm9Gk97kvFyd8vTNJh3Ki0ojOeYEfGZWKeR6y2iHVGvsnI1hnZJkuESU7r6/hnXGXTKIQo0EZhWoX2IsH0Ejtr6tlgOo2dDHaucEuNaTXNrqYeDFXQ2NFgvEqkqzpqrigolUKFhvow4M4Lfudx+8Bw3zHsPOHY4cYK7SV20tjZIKQgFzmFLCjK4m3KhdQs+y2H8xE7H6jCgmpGjseZ03GinxZcmFGuo/AzXduw3/XMU0CWr8K/mUMhBNPUcv94xg89sfrxxKIQqafTuCwoohOV16ykjBYn33bKS4RlWaZKbp/+YDg9Mi0LztW3+VJphFQJRkuqSif9Zdk7sok/loWgqxucrGl9zTg2WGeJ3WTDgIym4QPj0LDdBrrg35dNTC0czkwPj7hhojt9oRm3NF1PGZYk4s2vv5BnG9brKzabDVnC+r8pR0LTtAwPT4xfvjFenhjOv+G8p3INxkdrC0itqesKbQzKVM+WF27tl4oSmWtr8WHADjMueqMPVOMOG0aqqkqE8XlQxmBiD+tnwuf58oUwRliWRbJ+04brJqUQpUK4QOkCItrVZk22XqcefkGyr+f5W8rx9CiZYXuiDSPjPLDsBtq2SUTxp4++JynCl+fPGXfFMKco3xJFaXzskfoX5gqrdJg+CAsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"callTapsSeries\"\n        title=\"callTapsSeries\"\n        src=\"/blog/static/0a6bef843d8f38a95e315423b2739054/ae6b7/callTapsSeries.png\"\n        srcset=\"/blog/static/0a6bef843d8f38a95e315423b2739054/63868/callTapsSeries.png 250w,\n/blog/static/0a6bef843d8f38a95e315423b2739054/0b533/callTapsSeries.png 500w,\n/blog/static/0a6bef843d8f38a95e315423b2739054/ae6b7/callTapsSeries.png 655w\"\n        sizes=\"(max-width: 655px) 100vw, 655px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>以上梳理了tapable中从生成钩子到触发钩子整个过程,可以看到在实现上tapable许多比较巧妙的安排</p>\n<ol>\n<li>Hook基类实现了所有钩子的创建方式 子类可以通过组合或者过滤对应的实现来实现不同的钩子</li>\n<li>在HookCodeFactory基类定义的工厂函数的不同组装方式,子类通过父类的接口自定义了不同的实现方式</li>\n<li>在实现call方法的时候 会使用上一次创建的结果函数</li>\n</ol>","fields":{"readingTime":{"text":"6 min read"}},"frontmatter":{"title":"深入浅出webpack-Tapable","date":"2021-04-06","tags":"工程化","path":"/webpack-tapable","top":null,"summary":null}}},{"node":{"id":"38451d99-8c2a-5516-9e4e-a0b856c2db8b","html":"<p>在使用React进行业务开发的时候setState可以对组件的数据进行更新并且触发页面的渲染.本文从源码角度梳理在调用setState的相关处理逻辑.</p>\n<h2>前置知识</h2>\n<h3>React多平台渲染</h3>\n<p>React在设计上使用了依赖注入的方式,通过注入不同平台的渲染renderer来实现多平台的渲染能力.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/5c744/reactRenderer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAABg0lEQVQ4y5WUiXKDMAxE+f/fZLivHBBu3HmiSyCFdsrMxrItrVeyHG+aZjdNk2EYhg37ed/3bhhGWxvH8Xv+9tvD42dZFvd8Pl1RFO5+v9tYlqWhqip3u91cnucWwBwbvziOjXSeZ8OBEIfH4+GCILAAwDxNU5ckiZGiTERRFNmeCDeFTCB8vV7mjBMq6ro21aiUcvyaprG1LEttpAQHhTK0qJRQByFqAAegEmL2sed5+VnDvVzZpNZ1nQX5vm/AZo09sBexjz0QrlhLQG1QI3IUY7O3J7pU+Jm6LqBtWwM2xErzLO5C4Tt9LoBLAthXvr8qlI0qLkKE2HQCKf9LIW1AEJdAW1A72Yzs4fOnQp1CAB+K9EoYAW3Eh8+VUk9kfKQEAYHquTAMDdgiZY8D+U4VkgKOPDs9M/UhTwxg00qUgEbHl0NOXwqOWZYZKQEokVrmSp/gtQSl+XL46VtmkaJD0rYrkd72utZuhPoTYY03fvpvA1CBM8DG4WxNTQ4p+KzhFxiCKgcyB0LkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"react renderer\"\n        title=\"react renderer\"\n        src=\"/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/00d43/reactRenderer.png\"\n        srcset=\"/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/63868/reactRenderer.png 250w,\n/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/0b533/reactRenderer.png 500w,\n/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/00d43/reactRenderer.png 1000w,\n/blog/static/9bca1c5b0e82f7200da7c0c3d9f20d54/5c744/reactRenderer.png 1206w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n在创建组件实例的时候,React会注入不同平台renderer最后结合react-reconciler来实现组件的渲染更新.</p>\n<h3>事件循环</h3>\n<p><a href=\"https://icantunderstand.github.io/blog/event-loop\">事件循环</a></p>\n<h3>lane</h3>\n<p>在react新的架构中定义了lane的概念.lane用于控制不同任务的更新优先级处理逻辑,具体可以参考<a href=\"https://react.iamkasong.com/concurrent/lane.html\">lane模型</a></p>\n<h2>源码梳理</h2>\n<p>基于React的多平台渲染架构,在梳理setState源码是从以下两个方面进行的:</p>\n<ul>\n<li>注入渲染renderer(setState从哪里来)</li>\n<li>发起调用(setState做了什么)</li>\n</ul>\n<h3>注入渲染renderer</h3>\n<p>在<a href=\"https://icantunderstand.github.io/blog/react-render-interpretation\">图说React渲染流程</a>中,React会根据当前的页面结构创建workInProgress树,注入renderer的逻辑就在创建组件实例的过程中.\n在创建<a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react-reconciler/src/ReactFiberBeginWork.new.js#L943\">类组件</a>的时候,会执行constructClassInstance创建组件的实例.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 724px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVQ4y42T247bNhRF/RuxRPFOUferZXuMMdpBmiAPyUOemqekLfr/n7AKyc5MGwRNHjb2JiQungMe7jIpcc1IHE8My8BwHJhOE93cEnNPlmUIITb/Ge0yISjHhf76muZ4oTssNEOLizn7V/vnH38WuhNpSnv5lfOH3xmuT9SPJ6R3rAet1X+74UfgnVGKEAtsHrEh39r0uSdNEtJkf/eEZP8KIdIfQnd6DcYhpEasrh3GOlxR4coamxe4WJK3A9qY/4Wt33ZZJvD1RPnwRPP2I9Nv76mmI7GfyOv2BiyqO9A+A1f/Xt5JKQnaUtQ9+eFC1fX4siXUPVYrkue2999t+VvwBtRao60i1B5fO0LrCN0t+8ZiosGVFl9bXGXw7S2bqHGlIR89tjT/AhqNcpJ8tITeEjpLPjri7MmHFe6Io6dYAnEKFHPYgF8PWGFrESbolwp9WVEtR8pxpDwsxK7F1S3aWZRRKCNRWm6+tZekiESQJinp5uKlQrUCu57q4bKpXBbifKA6n3BNjS4qpFVkViFWaNBIpzatWTmFdur+UjJJNIa+rpkPh01D1zLPM0NbUg3TdutVDESTEbWkcOse+ZztWr29A7XMaNYqjcZ4g3Gr6829TIk2JTerBEHdsxbkKiUYQakzYpKSiK+DbQQHnfLpMeXzk+DLG8Uf7wyfnwxd3+D7kdB2+KrePO8HbFHgm47Q9eTeUayjIyXy9pYF5+j46+3C3+/O/Pl65MsvHZ+uE9fjA+fjI6dx4TguXE5XjsNhy+fDA8dh5tSODN2IzfNtTrdLKaqGUM2E/oQdz6hmQsYWFSJaydtwp8lda05f1iL9z0v5Bw9BzFQeJzKMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"constructClassInstance\"\n        title=\"constructClassInstance\"\n        src=\"/blog/static/497d1ecebae05943263e87a1e98aa231/a242d/constructor.png\"\n        srcset=\"/blog/static/497d1ecebae05943263e87a1e98aa231/63868/constructor.png 250w,\n/blog/static/497d1ecebae05943263e87a1e98aa231/0b533/constructor.png 500w,\n/blog/static/497d1ecebae05943263e87a1e98aa231/a242d/constructor.png 724w\"\n        sizes=\"(max-width: 724px) 100vw, 724px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n在<a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react-reconciler/src/ReactFiberClassComponent.new.js#L591\">constructClassInstance</a>中主要做了如下两件事:</p>\n<ol>\n<li>执行构造函数,创建组件实例</li>\n<li>注入组件更新逻辑实现</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/1432b8761f07738688fa565358af68b7/1bba8/executeConstruct.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVQoz42S7W7bIBhGexmrbcAuBvwBCeQ7Wbt0bZJqSqPe/9WcyY4qdVun7ccR/Do878N7I8qKqkuUbeTb84GXyxvH1wuny4XT6ys/3t6YpkSe50gp/8mNEAK/vid8fWR5OrM9nFk87Nken4mLFSHOqI1BFMX/CYs8x853uLSiWyaElGRfbsmzbCTLbin+kAmE+IuwLEtsSkzuN/QTizaKUiuqWo6phgdHipwiy8ZTfCIaJh2FsqywXUeTeuwq4jYzmnlPs5yimxbbB0zn0dZh/ITaOqQQo+Aj79IbKQp03KH8EjVdU0+X+Pkav30i7k8sD2dm+yPx8cT8cGb+/QXjGpRSSFVe+SWhlNzVNXVao3dHms2e+PBEWm9RztP1ntpPKeMG7RPtfI1rW0wXKP2Cqk/I8u6adBAqJamqikpr9GyLmSSUtlTGXTsbyDPE0N3AeC+uid75+CmyLAixI20Ci8fI7jCj7wzWOayfXukDd8aibEvVTdC1uQqGsaX6TSglIXQE39C3lq51hNDQeI8NEesnuBDRQ2+uo+oj2phxdT5bm59BfiES78o9rwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"执行构造函数\"\n        title=\"执行构造函数\"\n        src=\"/blog/static/1432b8761f07738688fa565358af68b7/1bba8/executeConstruct.png\"\n        srcset=\"/blog/static/1432b8761f07738688fa565358af68b7/63868/executeConstruct.png 250w,\n/blog/static/1432b8761f07738688fa565358af68b7/0b533/executeConstruct.png 500w,\n/blog/static/1432b8761f07738688fa565358af68b7/1bba8/executeConstruct.png 642w\"\n        sizes=\"(max-width: 642px) 100vw, 642px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>在<a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react-reconciler/src/ReactFiberClassComponent.new.js#L581\">adoptClassInstance</a>中在实例上注入了updater实现了组件的更新注入能力.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 758px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVQoz1WR0XKbMBBF/R1FQkICIYSREGC3rk3cpk3+/49OB+xk0oczV/tyZnX3UBqLDok29ixLT54C849Imnt8ytRpweUzNgzUsacOnjZO+HGmOQaabZ4idVMjheCgjcLnkeHnzHDOhCVzunT8XQO3qeeaPesycB4ctTHYqkLpB6aqMFrTGINSirIsOWitidcX8u838usbw3VleVn59f7K5XZi/XPndr+QBocyCmXVntsi2j5Qz5RSPoRp9KSpI06Bboy0OWGPAZdHmjHjUkQbidLiM1UlqRq9Y565C1VZEodEvL9z/H6jn057R12a8TsTTddThYRqjw/8gHYdUsj/2L9srcE2DuM8la0xrsW2Htt2O9ust47agHLdk4Bu2l3wlX1DY7dCS0Txbb+SEAWi+IIokFIgiwIpnny8pfwUfUj/AfXDysLcW3bxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"注入updater\"\n        title=\"注入updater\"\n        src=\"/blog/static/0ec8d69c0ef510e14f1fdd507ed5c0af/c8e86/adoptClass.png\"\n        srcset=\"/blog/static/0ec8d69c0ef510e14f1fdd507ed5c0af/63868/adoptClass.png 250w,\n/blog/static/0ec8d69c0ef510e14f1fdd507ed5c0af/0b533/adoptClass.png 500w,\n/blog/static/0ec8d69c0ef510e14f1fdd507ed5c0af/c8e86/adoptClass.png 758w\"\n        sizes=\"(max-width: 758px) 100vw, 758px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>发起调用</h3>\n<p>在组件的实例化过程中,注入了提供更新能力的updater.调用的逻辑其实就是梳理对应的updater如何触发页面的更新.通常调用setState是如下的方式:</p>\n<pre><code>this.setState({  })\n</code></pre>\n<p>setState是挂载在组件实例上的方法,在创建类组件的时候会调用React<a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react/src/ReactBaseClasses.js#L20\">类组件的构造函数</a>来初始化实例.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 723px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.599999999999994%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVQoz22S6XLbMAyE/R6WRPDWQdm6bCdO4jTt9P0f6euI8tiTtj92FiAxywXAnU8G7RXaCcYLJghiq4z13ER5xGIl19nWZC7LkqqqvmFnmog4iwoGaRwSLMp5bAz41GLrQOgTfq0zCqW3x1f+WywLSrcQlxv97Yt4vpCuP7FpxoYG1/RYXxP6CesCVVlR7MsHyuKO8sk7XXfU84nxdiPNR/qXF7plRtvVTYnSFUo2Fre1LFahg87xlm+8OQwB23WENuKnAT2fsdOMbTzaKbTfitcHdJ7xXcjLP3kW1NFRzw3dpcOniO1qXKpxjWO9c31AR4uJDhNtdpZFVsE1rvVDfHPoIr470C5njPPEfiB0B4z1qG5C9SfkeEEOJ0yaUEooi+I5t+L7LHc6Bipn0dZhfMyiJkRMCJm182htENkcVKr673afW+47VLu2mIiHCd/2mdfNNtM55946rDEU+z3Fvrhj/+0fZsfZ4ZgwQ0s8JprlRDMODGPNcawxwaHbhD8OtPNEuyy0y0w99PQvr6RholKKongK72zf071dGH9+Mr2feP0xc/2aef81M1xn4jLRX88cP64cP95I55H5943x80qKgaEJtDGg7iPZxbqhLAXRDlGC0Ru0SM4rpVErxGyoJPN6LqrCrrVaHm3/AZ0jV2qMuOQFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"baseComponent\"\n        title=\"baseComponent\"\n        src=\"/blog/static/2ae56cda731fe7c84a8d82990745f055/c67d4/baseComponent.png\"\n        srcset=\"/blog/static/2ae56cda731fe7c84a8d82990745f055/63868/baseComponent.png 250w,\n/blog/static/2ae56cda731fe7c84a8d82990745f055/0b533/baseComponent.png 500w,\n/blog/static/2ae56cda731fe7c84a8d82990745f055/c67d4/baseComponent.png 723w\"\n        sizes=\"(max-width: 723px) 100vw, 723px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在调用setState的时候其实是调用注入的updater(classComponentUpdater)的enqueueSetState逻辑来实现页面的渲染更新.\n在classComponentUpdater中主要做了:</p>\n<ol>\n<li>创建update 形成update的链表结构(updateQueue) 在更新阶段会依次处理链表的update</li>\n<li>通过scheduleUpdateOnFiber触发更新</li>\n</ol>\n<p>在<a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L456\">scheduleUpdateOnFiber</a>中获取到根节点通过ensureRootIsScheduled发起根节点更新调度.</p>\n<p><a href=\"https://github.com/facebook/react/blob/a423a01223785a8bc4dcd55f2a0288200b033eee/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L632\">ensureRootIsScheduled</a>的功能是在根节点上调度任务的执行,主要功能如下:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 759px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 125.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD+klEQVQ4y32V2W7cRhRE9RnJDMneSPbG5q7ZR5a8JDYMBHnK///JCUhNZFm281DongFYqMuqW7yTpUWFhBsb5nPL7tJzfNdxOiWGNmBjom4CfmwxtsbUjtIFSudwfcJ6hxCCPM8py4o7qRTaR6phpAiR3Do+7Cv+Piq+ToJKFWSbLWK7Jc8ysmxLtty3W4rbfwtZURTreSeKgjokmvmAdR7fz/huIkx7bOqpfMSNO2w/44Z7/LRfT9dPGB9R3Q5Z+5V4Ib0rhUS7BlEHZDOg2hnZjAiXqKyl7TxDH+m6Z6Q2UlbVi6r/sPzOF0IlBFUcMNMFffiAuXzGnP5A799TT0fSOJGuT7SPn1akyyNxmF4UrUSvR1Y2YJQknhLtx5F46fCHlnBu6Z5a4j5g+kg1J6oxUo0BZfRPFa4jS2MwStNYjykleb4hz7cImaNKgVBiNeA7vCF7jTtVLlEocb3DthbbLXGwGK/INhn5ZkOe3dxcHf025s+wxsb6RHr6RPr4hf7zX8SHpzV7dVxcnFFpRDWL4x6pnlULuaCgEMV6rvdVofVIUSCtRjclJpXoaKiHGjtZ7D5Qzw6789jRop1c1RsvkZXAOPWMoJFacCetR2vJcIpMDw3jNTJeIuO1YbhEpmvD/JiYHhLd3uM6T9Va4j7hR7eSLypfTFnWpi5Ldqc9+w+PzA8Xdo8PzOcTqfU0raNJjhBqQqiwwSPLmirc8ljkb1yWEikkLtR0UyQuBL0nNJZmUdLWpM4RfI3Wmu1qUsZ2s6xg9mMOl5drTMn9MDDdt4RUEzuHjZbQOkLniL2nGQJlXa4PSvlsirxBiDcKlZI0yTLMka539FNEDztUN6LHe9QwI1NH4RqcqxiHQNt6hiEyz4kY3Zt3aD2u6akXdBOq8hTGkmX5OlaWCwqpKJRekQtJIeVKkv3QNkIQm477658MT19JX/7BXz4xvv9Id76yO0w093tEM6LStEKEltI3yKUHfzBFCJZwh8OZ4fE9/fWR8XplPB0Zjgd8ainrmrKqKdaN2VLctubtHt9Mkdi6JpYaq3NqnWFNQaUFlZFIbSiUQVf1bcQbbvfXZDdTBNYuJXpFzVfk/IDoj4g0U/iesirpF5cbS9cHpqmh7+OazSWny/Ovy2IdecnX8l1RsUc3A9I16NoilURptaZgjYl4HZVnvFb34nJZW+LhgXh8t56uG5iOO/oh0XUe758dz4ufN813Iy+ExhjaeWa+nOl2M/1+x/3lxDT3a95i1yIrj2uHdZpfletz22iDMRqpljz9Rp7/TlFsEGLBUqibb7j1YVHkvyzZO2mqtffSeSad98TDTNwNuClR7eb1wyVDh/QJqfT/tvVC+C8D+9HyjMLmcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ensureRootIsScheduled\"\n        title=\"ensureRootIsScheduled\"\n        src=\"/blog/static/df31f836b5cc428cf2864f9bdd7254d1/ef3e1/ensureRootIsScheduled.png\"\n        srcset=\"/blog/static/df31f836b5cc428cf2864f9bdd7254d1/63868/ensureRootIsScheduled.png 250w,\n/blog/static/df31f836b5cc428cf2864f9bdd7254d1/0b533/ensureRootIsScheduled.png 500w,\n/blog/static/df31f836b5cc428cf2864f9bdd7254d1/ef3e1/ensureRootIsScheduled.png 759w\"\n        sizes=\"(max-width: 759px) 100vw, 759px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>根据当前任务获取优先级通过Scheduler发起不同优先级的任务调度</li>\n<li>同优先级任务合并,不发起新的任务调度</li>\n</ul>\n<p>setState是SyncLanePriority优先级,在调度上就会通过微任务发起调度逻辑等主代码块执行完毕后开启微任务执行(调度更新)</p>\n<h3>图解setState更新逻辑</h3>\n<p>假设我们在这样一个场景中在一个函数中连续调用的两次setState</p>\n<pre><code>this.setState({  })\nthis.setState({  })\n</code></pre>\n<h4>第一次调用</h4>\n<p>在第一次调用setState的时候在fiber的根节点上创建了updateQueue添加此次的更新内容,通过微任务发起调度.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/00a176694c87a68e767f39aea74c21fa/61016/setStateFirst.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/0lEQVQoz41S266EIAz0/3/TC8YLRBBBFLuZrt24J+6efZhAUzqdTin2fadt2xg5ZzqO4wXkBMjdvc3InXmgWJaFjDGktebTe89A3LYtNU3DMYpTSvzGWkvDMJC3lqwxNGlNKYQnYQiBi7uuo3meuQgAyTiO1Pf9G+E0TeScY9I1BPLOMVKMT8IYIxdCDch5jHMcxFAk4wLSkG242CNveGQoxAhQKF6gkVIt1XXNisRTyV/9vaK4Gi1mA+u6sjqoR9NvJG+EQnDtLKcsDI1+IXspvPse1jpegFgRzi1+J8yfCZVSVFUVlWXJd5D+/ZsfFOZbQiwCJADu8fwW/yl8AGbIDaEzSvt9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"setStateFirst\"\n        title=\"setStateFirst\"\n        src=\"/blog/static/00a176694c87a68e767f39aea74c21fa/00d43/setStateFirst.png\"\n        srcset=\"/blog/static/00a176694c87a68e767f39aea74c21fa/63868/setStateFirst.png 250w,\n/blog/static/00a176694c87a68e767f39aea74c21fa/0b533/setStateFirst.png 500w,\n/blog/static/00a176694c87a68e767f39aea74c21fa/00d43/setStateFirst.png 1000w,\n/blog/static/00a176694c87a68e767f39aea74c21fa/aa440/setStateFirst.png 1500w,\n/blog/static/00a176694c87a68e767f39aea74c21fa/61016/setStateFirst.png 1770w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>第二次调用</h4>\n<p>第二次调用setState获取的更新优先级跟之前任务一致,这次只进行updateQueue逻辑增加任务的操作<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/b6e50/setStateSecond.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQ4y5VTa6+CMAzl//9BEz8J4SWMMQGBjY3enGrRq3gfS5qWPk572hB578laS/M8k3OOQgi0ritrax3Lsiz8DY08iNRAIyYSAdC0LSmlqO97diKx6zrK85yyLKNhGLiJ1ppzLpcLlWVJ1+uV6xCHfxzHG2DbtreEYWBAYwwnAaCua26A6WAjhnzEqqpiIMTADjryIWyAmGqaJu6Mh46IoSkEMfggYsP/TtkY7giNRNlVmqaUJAlPIXsVHcLKtjQTibwPW+JKtBUAFA2wI1n8a/G7BIok0eJ6dwoQPAABFO93sCdAZy1VZUlFlpFWineI/RRFQefzme09ej8CAqhRNRmt+WJN0/AO87xg+5Xy3jcfRQK8wyfBDkEZx4J+BfkIuDc6T+0cnU4nOhwO/6B8v/InwDiO6Xg8MuDfruwflB80wlYMUPkDxPddhzfKX/ab9wsUR/UWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"setStateSecond\"\n        title=\"setStateSecond\"\n        src=\"/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/00d43/setStateSecond.png\"\n        srcset=\"/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/63868/setStateSecond.png 250w,\n/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/0b533/setStateSecond.png 500w,\n/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/00d43/setStateSecond.png 1000w,\n/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/aa440/setStateSecond.png 1500w,\n/blog/static/76f16d8aefefa3d39948c2f406cdc6cb/b6e50/setStateSecond.png 1862w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>更新任务执行</h4>\n<p>微任务执行,开启更新逻辑</p>","fields":{"readingTime":{"text":"5 min read"}},"frontmatter":{"title":"setState源码分析","date":"2021-04-01","tags":"React","path":"/react-setstate","top":null,"summary":null}}}],"pathPrefix":"","first":false,"last":false,"index":9,"pageCount":15,"additionalContext":{"pageAllCount":89}}},"staticQueryHashes":[]}