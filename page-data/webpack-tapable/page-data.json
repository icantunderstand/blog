{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/webpack-tapable",
    "result": {"data":{"markdownRemark":{"html":"<p>webpack是前端代码的打包工具,熟悉webpack的的工作流程和相关配置有利于在业务开发中更好的组织业务代码和实现一些特定的功能.webpack主要基于loader和plugin来实现代码打包过程:</p>\n<ul>\n<li>loader 主要提供了非js文件的处理能力 通过loader依次对目标文件进行编译</li>\n<li>plugin 主要通过webpack在编译期间的钩子来对编译过程进行干预</li>\n</ul>\n<p>webpack的钩子触发逻辑都是基于Tapable这个库来完成的,在深入浅出webpack这个系列文章中我们先从Tapable的源码开始逐步深入到webpack的源码中来了解webpack.</p>\n<h2>Tapable的简单使用</h2>\n<p>Tapabel提供了多种类型的钩子和订阅钩子的触发方式,这里以SyncHook来梳理一个简单的钩子使用方式.</p>\n<pre><code>const { SyncHook } = require('tapable')\nclass Car {\n  constructor() {\n    this.hooks = {\n      // 定义一个同步钩子 钩子的构造函数接受多个入参\n      accelerate: new SyncHook([\"newSpeed\"])\n    }\n  }\n  // 定义设置速度函数\n  setSpeed(newSpeed) {\n    this.hooks.accelerate.call(newSpeed)\n  }\n}\n// 实例化\nconst myCar = new Car()\n// 监听钩子accelerate的触发 \nmyCar.hooks.accelerate.tap('acceletePlugin', (newSpeed) => { if(newSpeed > 100) {\n  console.log('不能开太快呀')\n} })\n// 调用实例方法 设置速度 设置200的时候 会触发提示\nmyCar.setSpeed(200)\nmyCar.setSpeed(100)\n</code></pre>\n<p>通过上面的例子可以看到钩子的触发的逻辑是:</p>\n<ul>\n<li>创建钩子,定义钩子参数</li>\n<li>订阅相应钩子的触发和拦截功能</li>\n<li>触发钩子</li>\n</ul>\n<p>通过钩子的触发逻辑可以看出Tapable的实现逻辑可能是基于发布订阅的方式实现的,但是它里面对订阅的处理是怎么处理的呢、如何高效的触发呢? 这些都是成为一个优秀的库所必须要考虑的事情,我们就带着这些疑问来看Tapble的实现逻辑</p>\n<h2>源码逻辑</h2>\n<p>以下源码梳理以SyncHook钩子为切入点,分为以下三个模块梳理:</p>\n<ul>\n<li>钩子的构造过程</li>\n<li>订阅过程</li>\n<li>触发阶段</li>\n</ul>\n<h3>钩子的构造过程</h3>\n<p>在通过new实例化<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/SyncHook.js#L35\">SyncHook</a>的时候在SyncHook的构造函数创建了底层Hook的实例并且重写了Hook的方法过滤了SyncHook不支持的功能\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 469px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxElEQVQoz32SSY7bMBREfY1Y1ERNlijTFiXLmmxJnhKgk00WuUZWOf8L7E660Y1OFgUQxK+Hqk8u3CBGbjv8dY1UhrbZchgq5qlmW7eo5kiSpmy1Jsk15fUbySolyEuCckRu9sSmoygLXM9l4fk+wSoiUCGrMmFdJ2z6DDMr1D5l3WvWfUpWRbiehxeEOI6D4/k4foDjSVxfIgP5uF/4novMNkhdI7VBtmdilSFzg78tCcYa1dQU841YrVl3I6Y/EvgeQljYto1tC4QQj/PCc10C0xH2F/L2gBou5N2EPpxJdIGpNNNpz/XzgX7Y4cmAeyvXdZ+TvtPCv1dOQpIyYXdYsW8jmj5GlRGqStkeFc3FkOsUyxI4tv1ivkPf61E5NB1+c+HHmPHru+bn14xOh+Q65zTXXK8tT08jSq2Q0vsw2WvC+w5Ni9ec6dqC26nidtoxDAZjNoxTzTTVzHPN+dxQGI1lWQ/z8/7eauE6NnHRkrY3mn3F/GWi7mviKGIYSo5jRbXbYNsuy6WFEPYL7MOEURyhVzllskFFGW45EBV7HCFYWuIPRLwx/Qv2AKb3LxIGfLKWj+d3xBJbWB8O/w/0F/gbfDImzfUplnYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"同步钩子构造函数\"\n        title=\"同步钩子构造函数\"\n        src=\"/static/fabb95efaaa8baad0c7438753b657a71/5f759/SyncHookCon.png\"\n        srcset=\"/static/fabb95efaaa8baad0c7438753b657a71/63868/SyncHookCon.png 250w,\n/static/fabb95efaaa8baad0c7438753b657a71/5f759/SyncHookCon.png 469w\"\n        sizes=\"(max-width: 469px) 100vw, 469px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n在底层<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L25\">Hook的构造函数</a>中主要做了如下的处理:</p>\n<ol>\n<li>入参存储</li>\n<li>创建不同方式钩子调起(call)逻辑</li>\n<li>创建不同方式钩子的监听(tap)逻辑</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 441px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.00000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE4klEQVRIx32Va2/bRhaG/Su6tkRyOJzh/X4RKVE3y5bt2AnSdNMWbrPtdi/AFtgW7WL/P56CZOzYTdoPQ1Eg9eg9533PzInjCFSUoeoddtVivX2H+eZ7rLf/QNz/G+v1t3h+iMoaVLNB1z1xVRPGEfXVHUW7xPc8TNPEsixOdDTDsmykKwkWAclFRXJRk143xJcNwa4kqD2izifbx8TLgKj1iVcB6SbGVjamMcFGoJucYZk2UgvCxiXZBgQLl6DSlGvNcq8JKxcv14RLH+FKTNtCSIElLUzLxDIn2KDyREUzxKDQ17iFR7UOyDKNqnz6VnHff0YSCYLaJ4wduo1Pe5kSLXzKfYxynecKhZhuVFKj05Yvzhu+2mf4YUTVLFjUJU0V0+9aXl8t+PlKsS89FklEEwdEUfSobgSapoW0bXI/oY0bSi9CJxVeWvHjpcPrlY/2Q+K2pz0/Eo+K5pjvIQ+gR4VybhBE0ahobhqYtj2+LCwL25ghzPn7HxoYhsHcMBhEDN/N8f7hc4Kf+FIivRDVHJB5jdr3uHWF7wcIpbFsOVYgpcSWDo52EWIwxEEoD0sqbEePzyeFjsIZoFGBqrbItEWmS8K6p9ofSboNeVGQJAlh1VLsjrieh5MvccoembX45YogCBC2zYmQJkLY2EIgkxKvrMg3K8rDBa7rElUteb8fWzCW9qS8T5aswik2trRxAhe/DsjPc+IuRjoOUnsMVVi/a/4frZPhMvTEHvqUL1FpQ7m/Jm3XYyQWl7dEefloyhjkJzH5CDg4ZttiKrnoUcmC+vCCvD+Q5hVNt0YqjS0kruthDYb8GdB2jKmHg8I4I6grkvWSaN1THg/k5zv8siCIPepFgRAm89n8EfpRDp/30MMtfYqFZrMOiBpNdShotgXlRUN+XpOsKpwnu8vjGuAPJYuhZFvgFD0yafnuWPOf64IoCvnrv95x//OP3Pz0X27+9yuf//8Xiq5hfno6Tcx8Nq330JPBkMkUgcy60ZQfLhO+2ccUfc/du3t2X37F9d9/4Oa7b9n/7Z/4VYepPOwwRQQJdhB/UPjBZTG67GQt7y4Lfvp8SXN5S7hYE4c+3x9i7voUsXmF3r1E7+5Qhze4118TLvdYQx4/AmZL3Kzhy13Ky5sD2e6aqKgo6obXdwfK7QG5uUX3R9QA3b5AVSuUF2AY84fYmGNkRpezDp0tSDYXlMdX5Os9URzhbF4gr+9R+1cjxL38An14Q7DYYM1OHw0aJ+V5sDvcoiNtl2TdmqDdobMGvbnF21xjJTVm1mHlHU65QvnhM9h0pszNyeUh2HmPSgfghrha4lZb3GyJLLZ4SU2ReGSxRxzqyVnD+JDHx/1Qz6ccDgrDiKDJyHct5dU5+bokyofjoMQtY7bHhtW2oijS8f1PTcuJ4z0BDhttnZL0FWHu4jcxelFTtQHdNsVQJmfGjL98djrO9cPx8RT8YZbHHk6zXO5vKPoD3tCrICetGqplTxS4VFVCloW4rub0dDaCn/XwwZTh34ZJ0XlLc7yle/mW5uoVebdCRxkiX1N0S+7uNty93LLdLWiaDKUUxtNTb7gM27fneQgdYGsfPyvw0gI/K/HSEuVIbDfAVMMp540Kk8SnLJNPA4dyhwfmfD7O53x29riMYRnmNLfDs/mc2WxaZ2cfl/wbpkc9NezuXmIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"底层钩子构造函数\"\n        title=\"底层钩子构造函数\"\n        src=\"/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png\"\n        srcset=\"/static/cddadaa923563693da8a82c7e4708f08/63868/hookCon.png 250w,\n/static/cddadaa923563693da8a82c7e4708f08/efc6e/hookCon.png 441w\"\n        sizes=\"(max-width: 441px) 100vw, 441px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>订阅过程</h3>\n<p>在钩子实例化的过程中返回的实例绑定了不同监听钩子触发的监听函数,这里我们调用<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L77\">tap</a>函数的时候,会调用内部_tap函数并且传入绑定的sync参数和入参.在_tap函数中对入参进行了处理和过滤器处理\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQoz4WRSY7bMBBF+xqtkRLF4iSKtGTHQ3eCbHKF3P8mLzDjAEE2WTyABImHX/Xf3ruRH8fEz+8Of/9G2Av545P8+IqEhIkZEUvXtnRNQ9e1L7rf9+a9vvV9zzAMvI3DwLws+GNnvV/wJeIfG3LPaDFsybGuDhHBxA0tFm0dWmtk3ZBUMC4wjkOVVuGkNf44SB8X1mvCPRLDFtFW2DZPzhHrPPb0BW0Ds3gWI8i2Y/OODZFx6P8R7gfpcSFeInJKqMXjRHM+J0qJpOQ4ZVcTn0qgZE9cYxW6cmB9oO+6vxMW4m3Hl4Bkj44BMZqcQ5V5b/BeKs8VBG+wIWCeY8fEYswr4fgULqhYkOi43jeut0S+3vDnB36/Ms8zTdvStl2laf6cX0W1TS2plqKUqgvvR8U0zUxKMQ4jappR8wul6uf/8Uz4CwkaymFOFPmPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"_tap函数\"\n        title=\"_tap函数\"\n        src=\"/static/b003abad27e92cd6307a316a5118d62a/267f6/tap.png\"\n        srcset=\"/static/b003abad27e92cd6307a316a5118d62a/63868/tap.png 250w,\n/static/b003abad27e92cd6307a316a5118d62a/0b533/tap.png 500w,\n/static/b003abad27e92cd6307a316a5118d62a/267f6/tap.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/Hook.js#L136\">_insert</a>中会根据当前监听项的信息将它插入到taps的正确位置.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 423px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABj0lEQVQoz3WSyW7bMBiE9RyRuGshRcm2YsubrDhxXNSXPkRPPff9D18huU2CtD0MBvxJDmcGTISU5Eqwrx4YQkbvJcYVaFdQliXGGLI0Q2SCLBWICdkHCIGUcuYJSSoUbS75cTH8/Ob5fqtZDgOPX270xx2+9Ugr0U5hvcGUGu002qp5pox6E52QTAvnHMYZbHAUq5ywzml2BbEvWY6R9hCIm4r1taV7bQl9SdE4/Logj252+i4oJcZoTFFh1yNlu2S3W/B07nl+2XK97jmeHhnPG8ZxQ7fscMaRPqT/jJ8IKbDW4gqD85ru2rK6xPn1ZvAsn2sW55rVayQePUpLtNVz1AlzdHuvQCpJMtl01uEKhws58RBYnCO+K2n2gXYI1NtA2FSzcL2tCJuSuq8IfUU8eBZPNe0pYJy+R3bWYkuP7QZ819O9fGV9OtP1W6pqEh7pL7e5mrkrJVHqzn+6e+swS1Ni2xDbSJoJlNZoY2dWSv0WuM8+fo//IZn6a5pmvvy+kf19OMuY+v7s6LPDXzgWA4uhdV6tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"_tap函数\"\n        title=\"_tap函数\"\n        src=\"/static/44794c72173ba543b2450d5ba600480b/f687d/insert.png\"\n        srcset=\"/static/44794c72173ba543b2450d5ba600480b/63868/insert.png 250w,\n/static/44794c72173ba543b2450d5ba600480b/f687d/insert.png 423w\"\n        sizes=\"(max-width: 423px) 100vw, 423px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>触发过程</h3>\n<p>在触发过程中是通过调用hook实例上的call方法,这里我们先梳理出call的实现过程然后在从源码的进行分析\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 363.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCABJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHu4IVAFRkLGAqUmVNDJvIuAKtNMAP/xAAaEAEBAQADAQAAAAAAAAAAAAABABACESAx/9oACAEBAAEFAtYxjEgiYj4vULjGNxx9f//EABQRAQAAAAAAAAAAAAAAAAAAADD/2gAIAQMBAT8BL//EABQRAQAAAAAAAAAAAAAAAAAAADD/2gAIAQIBAT8BL//EABoQAAEFAQAAAAAAAAAAAAAAACAAATFAQeH/2gAIAQEABj8CW0nkuD//xAAgEAACAQQCAwEAAAAAAAAAAAABEQAQITFBUWEggaGR/9oACAEBAAE/ITkRlP6FDULLvfuic/JtkX4gLjCbQhJ2MWlgm+GtxHruYIpLz9ppmL7K2LvtZppPY8X/2gAMAwEAAgADAAAAEKPMDHPHPOPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAwEBPxAv/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPxAv/8QAIBABAQACAwADAAMAAAAAAAAAAREAIRAxQVGBkWHR8P/aAAgBAQABPxC4CltmUYRJoDgAKWV7SfmGoR3EdDhJmid9sJKjpt7D3AFNmKin42TFZ0KhHeBgk24RdhCfZym0m3QN56PgxKH8rlXoV2Or5xHbbyFxIqAZ/tcCh9ncwJYZ/Y47rXu0uNfTfQh/eDn/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"call梳理\"\n        title=\"call梳理\"\n        src=\"/static/542d374ac0a67cda1e65467eec38cd64/aa65c/call.jpg\"\n        srcset=\"/static/542d374ac0a67cda1e65467eec38cd64/0479a/call.jpg 250w,\n/static/542d374ac0a67cda1e65467eec38cd64/aa65c/call.jpg 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/SyncHook.js#L40\">SyncHook</a>实现的父类的抽象方法compile,compile方法也是基于基础类HookCodeFactory组装实现的<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 111.20000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD4ElEQVQ4y32U2Y7bRhBF9RW2h71xF/d9FSmNZvPEAZz8RZ7y/68nIEcTO3bgh4smC+RBVd/CPZTGotWKNjC0vqHbTk/TeJr+aDOmzl6vjdrfh8Shj20qJSnlN9VCkEnJYYju8H2bqA/IzzHZFJIOIVHtUV0TsvlI0gckQ0D1GFE9pCRViJISJSRaSqSU2FpTbcDKlgRZQ1DVHE8l4bknvPQEa0+wtDhNgVtkBO1AOJwI+u27CW9o8YYGp8oJqoLAcSmE4JBakjEP+ftLyl+fE7qhJT4/k5+vpF1HebnSPX/hWLRk8xPpfE/x8Ey2vp3JMFG0Db7jkFsWh21+zyjqKOKxbinSFL+aqOqSeel5eFqZ14HLpWUaG45RhOuH2LaN0QatNUopbKXeOtyArrHRts14OTHfL0RRiOd5uMeYME5Qjk/TZDRNSl7mxGWD7/v73WmtUPoHoGcbjO1QnJ+pH38n7WaOZcuxqPHjFCUFQsibBFKIvautu71Drb8BN2dcrUnTjLSoCOKEY1YSFTVR2RCmOVopjNY/a4MqtQOdd+C2O47vYYchd0ryUVi7Plh3uz5aFp+U+kkft1NrrJs26A58UIoXz2eyBJPQTNKwSMWqNItSLEZx0jcZvZ+LVlyMYbUsKiFItuUWYn8+zJakKWfKpOJyWlgvj/R5QRVXlPVA2bd060y7znSXE+3YUdUFfZ4xbstsWbhKEdycPhTblhcDqj5RLyPLWjNNOV41IIoZp5op718p719ImgHbdZFK82EzU0oiKbnTGnkb+1BYFqHr0/XPRNlMNC401weyfqIbW9brQvv0heb6Qtl0uxnvRhyl3McVt9qmQ2s0WRzjGwfPGKQbINwQ2/UIQ5cg9HCDI05wxA+PGGP2lRFKvQGF+Be41Q+1lHTGkAuxp0YrLRolaLY0sSTFpztqsV2+RXF3t2tPGG1opSIxNsqYtw63kZU2OHmP16x45ch0mblcek7nifLxM/E476NGeUX3+idlP+EXPW454pTTXncdB/kO1ErihAled49fjQTr6x4Ex/ZMWJfU547L05VxPRFVHXk77FG1xdf27x5jN9g+8lY0SYmzvNIsC+vTme58Iq47/GYmP63Uz6/UTY4WFsKydkP0D3qHHmwlKYKYopq51Blfl5IvU8GahvRVRzE9U51+Izm94hVvLv8f8F2HUAimIKYcn3gcWr4+zdy3BUue8Me142XpGJOYRjto17u5+QugYzStF3CftJyOGVU702QVqRSkWpEpSSYFgbCQars3/RZZ36XNf4C242B7HpYUWEphybcdE0q/vSu975n8Lqp+1eE/vS2C791tVqkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"compile实现方式\"\n        title=\"compile实现方式\"\n        src=\"/static/f40c6fcf44a8453f6214b5593c81ed49/267f6/compile.png\"\n        srcset=\"/static/f40c6fcf44a8453f6214b5593c81ed49/63868/compile.png 250w,\n/static/f40c6fcf44a8453f6214b5593c81ed49/0b533/compile.png 500w,\n/static/f40c6fcf44a8453f6214b5593c81ed49/267f6/compile.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><br>\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/HookCodeFactory.js#L14\">HookCodeFactory的create</a>方法中通过调用contentWithInterceptors进而调用子类SyncHookCodeFactory的content方法,在子类SyncHookCodeFactory的content绑定的SyncHook的实现逻辑callTapsSeries.\n在<a href=\"https://github.com/webpack/tapable/blob/acd0a66d3769120b1e9e5b66823475043237f30b/lib/HookCodeFactory.js#L276\">callTapsSeries</a>中主要完成了订阅数组taps的代码串联逻辑最后返回new Function完成call的调用逻辑<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 122.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAADa0lEQVQ4y5WV627jNhCF/RitLVHiRSJFibr6GifeptldYIGiKAr0/R/lK0gnzgZFiuTHgQiSOpzhnDlcKaXwbcfXv/7h659/c3n6zjjNyLIkrkkpP4WVMYY8z/H7e/rLN+owIoqSXIg0/1kkwqIoaKYd7e6ErmqkUmTZBiHEp7HSWqdBOF2Yf/9Bf7pg+xFVO4TIbxvj6R8jlIpI2oQB03RU7UDle1TdkG3yhDzL35D+H/mqrhWllOjGY6eJZmhxjaSQG5Qt0F6hrLyRvoeXQ1bG6nSHhbVUweP3M37bMTwcafc92pdoF4uUkeeb2+VnWUaeZdfvT5GvjPOJ0DWeZhkJ91u6Q093f2C4HGiPI+1xoLsb03osWCkVta3RRqO1SXJ5jbC5EtbKUHUNuvPo1lIvge64xS89buzwu57utOC3Djc4jKnQlblp9ZWwqilETlk5yn6LP90x320ZdiPd3R3NsqCsRZoYmaCQAlGKW8ovV3BLOZ6Q7lAqnBs43J25/PjO/nRgbGfm3Zkm9Gk97kvFyd8vTNJh3Ki0ojOeYEfGZWKeR6y2iHVGvsnI1hnZJkuESU7r6/hnXGXTKIQo0EZhWoX2IsH0Ejtr6tlgOo2dDHaucEuNaTXNrqYeDFXQ2NFgvEqkqzpqrigolUKFhvow4M4Lfudx+8Bw3zHsPOHY4cYK7SV20tjZIKQgFzmFLCjK4m3KhdQs+y2H8xE7H6jCgmpGjseZ03GinxZcmFGuo/AzXduw3/XMU0CWr8K/mUMhBNPUcv94xg89sfrxxKIQqafTuCwoohOV16ykjBYn33bKS4RlWaZKbp/+YDg9Mi0LztW3+VJphFQJRkuqSif9Zdk7sok/loWgqxucrGl9zTg2WGeJ3WTDgIym4QPj0LDdBrrg35dNTC0czkwPj7hhojt9oRm3NF1PGZYk4s2vv5BnG9brKzabDVnC+r8pR0LTtAwPT4xfvjFenhjOv+G8p3INxkdrC0itqesKbQzKVM+WF27tl4oSmWtr8WHADjMueqMPVOMOG0aqqkqE8XlQxmBiD+tnwuf58oUwRliWRbJ+04brJqUQpUK4QOkCItrVZk22XqcefkGyr+f5W8rx9CiZYXuiDSPjPLDsBtq2SUTxp4++JynCl+fPGXfFMKco3xJFaXzskfoX5gqrdJg+CAsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"callTapsSeries\"\n        title=\"callTapsSeries\"\n        src=\"/static/0a6bef843d8f38a95e315423b2739054/ae6b7/callTapsSeries.png\"\n        srcset=\"/static/0a6bef843d8f38a95e315423b2739054/63868/callTapsSeries.png 250w,\n/static/0a6bef843d8f38a95e315423b2739054/0b533/callTapsSeries.png 500w,\n/static/0a6bef843d8f38a95e315423b2739054/ae6b7/callTapsSeries.png 655w\"\n        sizes=\"(max-width: 655px) 100vw, 655px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>以上梳理了tapable中从生成钩子到触发钩子整个过程,可以看到在实现上tapable许多比较巧妙的安排</p>\n<ol>\n<li>Hook基类实现了所有钩子的创建方式 子类可以通过组合或者过滤对应的实现来实现不同的钩子</li>\n<li>在HookCodeFactory基类定义的工厂函数的不同组装方式,子类通过父类的接口自定义了不同的实现方式</li>\n<li>在实现call方法的时候 会使用上一次创建的结果函数</li>\n</ol>","frontmatter":{"date":"2021-04-06","path":"/webpack-tapable","title":"深入浅出webpack-Tapable"}}},"pageContext":{"readingTime":"6 min read"}},
    "staticQueryHashes": []}