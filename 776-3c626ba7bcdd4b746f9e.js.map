{"version":3,"sources":["webpack://noodes-personal-blog/../src/components/lazy-hydrate.tsx"],"names":["d","l","u","b","p","image","h","loading","j","isLoading","f","isLoaded","L","toggleIsLoaded","v","ref","y","imgClassName","C","imgStyle","k","w","objectPosition","N","backgroundColor","P","objectFit","E","F","e","m","O","width","S","height","x","layout","I","images","J","placeholder","M","_","JSON","stringify","o","q","s","t","r","Object","assign","a","i","className","c","current","n","g"],"mappings":"4XAgBgBA,IAedC,EACAC,EACAC,GAAA,IAfEC,EAAAJ,EAAAK,MACAC,EAAAN,EAAAO,QACAC,EAAAR,EAAAS,UACAC,EAAAV,EAAAW,SACAC,EAAAZ,EAAAa,eACAC,EAAAd,EAAAe,IACAC,EAAAhB,EAAAiB,aAAAC,EAAAlB,EACAmB,SAAAC,OAAA,IAAAF,EAAW,CAAC,EAADA,EACXG,EAAArB,EAAAsB,eACAC,EAAAvB,EAAAwB,gBAAAC,EAAAzB,EACA0B,UAAAC,OAAA,IAAAF,EAAA,QAAAA,EACGG,GAAAC,OAAA7B,EAAA8B,GAOHC,EAME3B,EANF4B,MACAC,EAKE7B,EALF8B,OACAC,EAIE/B,EAJFgC,OACAC,EAGEjC,EAHFkC,OACAC,EAEEnC,EAFFoC,YACiBC,EACfrC,EADFoB,gBAGIkB,EAAWC,KAAKC,UAAUP,GAEhCjB,GAAAyB,OAAA,CACEnB,UAAAC,EACAL,eAAAD,EACAG,gBAAAD,GACGH,GAGL,IAAM0B,EACJC,gBAACC,IAAA,CAAcZ,OAAQD,EAAQH,MAAOD,EAAOG,OAAQD,GACnDc,gBAACE,IAAAC,OAAAC,OAAA,IACKC,OACFb,EACA7B,EACAyB,EACAJ,EACAE,EACAQ,EACAd,EACAN,KAIJ0B,gBAACM,IAAAH,OAAAC,OAAA,GACMvB,EAAA,CACLI,MAAOD,EACPG,OAAQD,EACRqB,UAAWtC,IACPuC,OACF/C,EACAE,EACA2B,EACA/B,EACAM,EACA8B,EACA5B,EACAM,MAaR,OAPInB,EAAKuD,WAEUtD,EAASsD,SAAWrD,EAAaqD,QAAUC,SAASC,WAC5DZ,EAAW7C,EAAKuD,SACzBtD,EAASsD,SAAA,GAAU,WAIfvD,EAAKuD,UACPC,YAAQ,KAAkCxD,EAAKuD,QAAA,E","file":"776-3c626ba7bcdd4b746f9e.js","sourcesContent":["import React, { MutableRefObject } from \"react\"\nimport { hydrate, render } from \"react-dom\"\nimport { GatsbyImageProps } from \"./gatsby-image.browser\"\nimport { LayoutWrapper } from \"./layout-wrapper\"\nimport { Placeholder } from \"./placeholder\"\nimport { MainImageProps, MainImage } from \"./main-image\"\nimport { getMainProps, getPlaceholderProps } from \"./hooks\"\nimport { ReactElement } from \"react\"\n\ntype LazyHydrateProps = Omit<GatsbyImageProps, \"as\" | \"style\" | \"className\"> & {\n  isLoading: boolean\n  isLoaded: boolean // alwaystype SetStateAction<S> = S | ((prevState: S) => S);\n  toggleIsLoaded: (toggle: boolean) => void\n  ref: MutableRefObject<HTMLImageElement | undefined>\n}\n\nexport function lazyHydrate(\n  {\n    image,\n    loading,\n    isLoading,\n    isLoaded,\n    toggleIsLoaded,\n    ref,\n    imgClassName,\n    imgStyle = {},\n    objectPosition,\n    backgroundColor,\n    objectFit = `cover`,\n    ...props\n  }: LazyHydrateProps,\n  root: MutableRefObject<HTMLElement | undefined>,\n  hydrated: MutableRefObject<boolean>,\n  forceHydrate: MutableRefObject<boolean>\n): (() => void) | null {\n  const {\n    width,\n    height,\n    layout,\n    images,\n    placeholder,\n    backgroundColor: wrapperBackgroundColor,\n  } = image\n\n  const cacheKey = JSON.stringify(images)\n\n  imgStyle = {\n    objectFit,\n    objectPosition,\n    backgroundColor,\n    ...imgStyle,\n  }\n\n  const component = (\n    <LayoutWrapper layout={layout} width={width} height={height}>\n      <Placeholder\n        {...getPlaceholderProps(\n          placeholder,\n          isLoaded,\n          layout,\n          width,\n          height,\n          wrapperBackgroundColor,\n          objectFit,\n          objectPosition\n        )}\n      />\n\n      <MainImage\n        {...(props as Omit<MainImageProps, \"images\" | \"fallback\">)}\n        width={width}\n        height={height}\n        className={imgClassName}\n        {...getMainProps(\n          isLoading,\n          isLoaded,\n          images,\n          loading,\n          toggleIsLoaded,\n          cacheKey,\n          ref,\n          imgStyle\n        )}\n      />\n    </LayoutWrapper>\n  )\n\n  if (root.current) {\n    // Force render to mitigate \"Expected server HTML to contain a matching\" in develop\n    const doRender = hydrated.current || forceHydrate.current ? render : hydrate\n    doRender(component, root.current)\n    hydrated.current = true\n  }\n\n  return (): void => {\n    if (root.current) {\n      render((null as unknown) as ReactElement, root.current)\n    }\n  }\n}\n"],"sourceRoot":""}